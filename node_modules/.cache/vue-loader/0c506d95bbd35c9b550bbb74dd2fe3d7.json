{"remainingRequest":"D:\\downloads\\UNIQ\\Gui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\downloads\\UNIQ\\Gui\\src\\views\\Smartphone\\components\\MessengerTab\\components\\ChatSection\\PrivateSubsection\\MessagesBlockItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\downloads\\UNIQ\\Gui\\src\\views\\Smartphone\\components\\MessengerTab\\components\\ChatSection\\PrivateSubsection\\MessagesBlockItem.vue","mtime":1625043597367},{"path":"D:\\downloads\\UNIQ\\Gui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685190017390},{"path":"D:\\downloads\\UNIQ\\Gui\\node_modules\\babel-loader\\lib\\index.js","mtime":1685190019507},{"path":"D:\\downloads\\UNIQ\\Gui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685190017390},{"path":"D:\\downloads\\UNIQ\\Gui\\node_modules\\vue-loader\\lib\\index.js","mtime":1685190022137}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBTdGF0ZSB9IGZyb20gJ3Z1ZXgnDQppbXBvcnQgeyBnZXRUZXh0V2l0aEVtb2ppIH0gZnJvbSAiLi4vY29tbW9uL3RleHRFbW9qaUNvbnZlcnRlciI7DQppbXBvcnQgeyByZXBsYWNlVXJsc09uUmVmcyB9IGZyb20gIi4uL2NvbW1vbi9pbnZpdGVzVXJsQ29udmVydGVyIjsNCmltcG9ydCB7IGFkZEhhbmRsZXJzRm9ySW52aXRlc0NsaWNrIH0gZnJvbSAiLi4vY29tbW9uL2ludml0ZXNDbGlja0hhbmRsZXIiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdNZXNzYWdlc0Jsb2NrSXRlbScsDQoNCiAgcHJvcHM6IHsNCiAgICBpdGVtOiBPYmplY3QNCiAgfSwNCg0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcFN0YXRlKCdzbWFydHBob25lJywgWydnZW9sb2NhdGlvbiddKSwNCiAgICAuLi5tYXBTdGF0ZSgnc21hcnRwaG9uZS9tZXNzYWdlUGFnZScsIFsnbWVzc2VuZ2VyRGF0YSddKSwNCiAgICAuLi5tYXBHZXR0ZXJzKCdsb2NhbGl6YXRpb24nLCBbJ2xvYyddKSwNCiAgICBpc0luY29tZTogZnVuY3Rpb24oKSB7DQogICAgICByZXR1cm4gdGhpcy5tZXNzZW5nZXJEYXRhLkN1cnJlbnRBY2NvdW50LklkICE9PSB0aGlzLml0ZW0uU2VuZGVySWQNCiAgICB9LA0KDQogICAgY3VycmVudFRpbWU6IGZ1bmN0aW9uKCkgew0KICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRoaXMuaXRlbS5UaW1lKQ0KICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgdGltZVpvbmU6ICdVVEMnLCBob3VyOiAnbnVtZXJpYycsIG1pbnV0ZTogJ251bWVyaWMnIH0NCiAgICAgIA0KICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVUaW1lU3RyaW5nKCdydS1SVScsIG9wdGlvbnMpDQogICAgfSwNCg0KICAgIGRpc3RhbmNlOiBmdW5jdGlvbigpIHsNCiAgICAgIGlmICh0aGlzLml0ZW0uQXR0YWNobWVudC5UeXBlID09PSAwKSB7DQogICAgICAgIGNvbnN0IHBvczEgPSB0aGlzLmdlb2xvY2F0aW9uLmN1cnJlbnRQb3NpdGlvbg0KICAgICAgICBjb25zdCBwb3MyID0gdGhpcy5pdGVtLkF0dGFjaG1lbnQNCg0KICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHRoaXMuY2FsY3VsYXRlRGlzdGFuY2UocG9zMS5YLCBwb3MyLlgsIHBvczEuWSwgcG9zMi5ZLCBwb3MxLlosIHBvczIuWikpDQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICB9DQogICAgfQ0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBjYWxjdWxhdGVEaXN0YW5jZTogZnVuY3Rpb24oeDEsIHgyLCB5MSwgeTIsIHoxLCB6Mikgew0KICAgICAgLy8gc3FydCgoeDEgLSB4MileMiArICh5MSAtIHkyKV4yICsgKHoxIC0gejIpXjIpDQogICAgICBjb25zdCBzcXVhcmUgPSAobnVtYmVyKSA9PiBNYXRoLnBvdyhudW1iZXIsIDIpIA0KDQogICAgICByZXR1cm4gTWF0aC5zcXJ0KHNxdWFyZSh4MSAtIHgyKSArIHNxdWFyZSh5MSAtIHkyKSArIHNxdWFyZSh6MSAtIHoyKSkNCiAgICB9LA0KDQogICAgZ2V0VGV4dFdpdGhFbW9qaTogKHRleHQpID0+IGdldFRleHRXaXRoRW1vamkodGV4dCksDQoNCiAgICByZXBsYWNlVXJsc09uUmVmczogKHRleHQpID0+IHJlcGxhY2VVcmxzT25SZWZzKHRleHQpLA0KICAgIA0KICAgIHNldFdheXBvaW50OiBmdW5jdGlvbigpIHsNCiAgICAgIHdpbmRvdy5tcC50cmlnZ2VyKCdwaG9uZTo6bXNnOjpzZXRHZW9wb3NpdGlvbicsIHRoaXMuaXRlbS5BdHRhY2htZW50LlgsIHRoaXMuaXRlbS5BdHRhY2htZW50LlkpOw0KICAgIH0NCiAgfSwNCg0KICBtb3VudGVkOiBmdW5jdGlvbigpIHsNCiAgICBpZiAoIXRoaXMuaXRlbS5BdHRhY2htZW50IHx8IHRoaXMuaXRlbS5BdHRhY2htZW50ID09PSBudWxsKSB7DQogICAgICB0aGlzLml0ZW0uQXR0YWNobWVudCA9IHt9DQogICAgfQ0KDQogICAgYWRkSGFuZGxlcnNGb3JJbnZpdGVzQ2xpY2sodGhpcy4kcmVmc1sndGV4dF9tc2cnXSwgdGhpcy4kYnVzKTsNCiAgfSwNCg0KICBjcmVhdGVkOiBmdW5jdGlvbigpIHsNCiAgICBpZiAoIXRoaXMuaXRlbS5BdHRhY2htZW50IHx8IHRoaXMuaXRlbS5BdHRhY2htZW50ID09PSBudWxsKSB7DQogICAgICB0aGlzLml0ZW0uQXR0YWNobWVudCA9IHt9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["MessagesBlockItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"MessagesBlockItem.vue","sourceRoot":"src/views/Smartphone/components/MessengerTab/components/ChatSection/PrivateSubsection","sourcesContent":["<template>\r\n  <div :class=\"[{ income: isIncome }, 'messages-block-item']\">\r\n \r\n    <div v-if=\"!isIncome\" class=\"messages-block-item__fit\"></div>\r\n    <div v-if=\"!isIncome\" class=\"messages-block-item__info\">\r\n      <div :class=\"[{ read: item.IsRead }, 'indicator']\"></div>\r\n      <span class=\"time\">{{ currentTime }}</span>\r\n    </div>\r\n    <div :class=\"[{ solo: !item.Text, 'solo-img': !item.Text }, 'messages-block-item__main']\">\r\n      <img\r\n        v-if=\"item.Attachment.Type === 2\"\r\n        :src=\"item.Attachment.Url\"\r\n        class=\"img\"\r\n      >\r\n      <div class=\"geolocation\" v-if=\"item.Attachment.Type === 0\">\r\n        <div class=\"geolocation__info\">\r\n          <span class=\"desc\">{{loc('phone:group:msgs:1')}}</span>\r\n          <span class=\"value\">{{ loc(`phone:group:msgs:2@${distance}`) }}</span>\r\n        </div>\r\n        <button class=\"geolocation__btn\" @click=\"setWaypoint\"></button>\r\n      </div>\r\n      <span ref=\"text_msg\" class=\"text\" v-html=\"replaceUrlsOnRefs(getTextWithEmoji(item.Text))\"></span>\r\n    </div>\r\n    <div v-if=\"isIncome\" class=\"messages-block-item__info\">\r\n      <div :class=\"[{ read: item.IsRead }, 'indicator']\"></div>\r\n      <span class=\"time\">{{ currentTime }}</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapState } from 'vuex'\r\nimport { getTextWithEmoji } from \"../common/textEmojiConverter\";\r\nimport { replaceUrlsOnRefs } from \"../common/invitesUrlConverter\";\r\nimport { addHandlersForInvitesClick } from \"../common/invitesClickHandler\";\r\n\r\nexport default {\r\n  name: 'MessagesBlockItem',\r\n\r\n  props: {\r\n    item: Object\r\n  },\r\n\r\n  computed: {\r\n    ...mapState('smartphone', ['geolocation']),\r\n    ...mapState('smartphone/messagePage', ['messengerData']),\r\n    ...mapGetters('localization', ['loc']),\r\n    isIncome: function() {\r\n      return this.messengerData.CurrentAccount.Id !== this.item.SenderId\r\n    },\r\n\r\n    currentTime: function() {\r\n      const date = new Date(this.item.Time)\r\n      const options = { timeZone: 'UTC', hour: 'numeric', minute: 'numeric' }\r\n      \r\n      return date.toLocaleTimeString('ru-RU', options)\r\n    },\r\n\r\n    distance: function() {\r\n      if (this.item.Attachment.Type === 0) {\r\n        const pos1 = this.geolocation.currentPosition\r\n        const pos2 = this.item.Attachment\r\n\r\n        return Math.ceil(this.calculateDistance(pos1.X, pos2.X, pos1.Y, pos2.Y, pos1.Z, pos2.Z))\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    calculateDistance: function(x1, x2, y1, y2, z1, z2) {\r\n      // sqrt((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)\r\n      const square = (number) => Math.pow(number, 2) \r\n\r\n      return Math.sqrt(square(x1 - x2) + square(y1 - y2) + square(z1 - z2))\r\n    },\r\n\r\n    getTextWithEmoji: (text) => getTextWithEmoji(text),\r\n\r\n    replaceUrlsOnRefs: (text) => replaceUrlsOnRefs(text),\r\n    \r\n    setWaypoint: function() {\r\n      window.mp.trigger('phone::msg::setGeoposition', this.item.Attachment.X, this.item.Attachment.Y);\r\n    }\r\n  },\r\n\r\n  mounted: function() {\r\n    if (!this.item.Attachment || this.item.Attachment === null) {\r\n      this.item.Attachment = {}\r\n    }\r\n\r\n    addHandlersForInvitesClick(this.$refs['text_msg'], this.$bus);\r\n  },\r\n\r\n  created: function() {\r\n    if (!this.item.Attachment || this.item.Attachment === null) {\r\n      this.item.Attachment = {}\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.messages-block-item {\r\n  margin: 0.75rem 0.5rem 0 0.75rem;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  &.income {\r\n    margin-left: 0.3rem;\r\n    .messages-block-item__info {\r\n      margin-left: 0.3rem;\r\n      .indicator {\r\n        display: none;\r\n      }\r\n    }\r\n    .message-block-item__content-filler {\r\n      width: auto;\r\n      display: block;\r\n    }\r\n    .geolocation {\r\n      &__info {\r\n        .desc {\r\n          color: #656F82;\r\n        }\r\n        .value {\r\n          color: #4E6ED9;\r\n        }\r\n      }\r\n      &__btn {\r\n        background: #4E6ED9;\r\n        &::after {\r\n          background: #fff;\r\n        }\r\n      }\r\n    }\r\n    .messages-block-item__main {\r\n      border-radius: 1rem 1rem 1rem 0;\r\n      max-width: max-content;\r\n      background: #FFFFFF;\r\n      color: #464646;\r\n    }\r\n  }\r\n  &__info {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-end;\r\n    .indicator {\r\n      width: 0.8rem;\r\n      height: 0.8rem;\r\n      background: #A7B7EC;\r\n      mask: url(\"/img/hud/smartphone/messengerTab/chatSection/doubleTick.svg\") no-repeat center / contain;\r\n      &.read {\r\n        background: #4E6ED9;\r\n      }\r\n    }\r\n    .time {\r\n      color: #A7B7EC;\r\n      font-size: 0.65rem;\r\n      line-height: 0.8rem;\r\n    }\r\n  }\r\n  &__fit {\r\n    width: 5000px;\r\n  }\r\n  &__main {\r\n    max-width: max-content;\r\n    min-width: fit-content;\r\n    flex: auto;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-end;\r\n    margin: 0 0 0 0.3rem;\r\n    font-size: 0.7rem;\r\n    line-height: 0.9rem;\r\n    color: #fff;\r\n    background: #4E6ED9;\r\n    border-radius: 1rem 1rem 0 1rem;\r\n    padding: 0.3rem;\r\n    &.solo {\r\n      .img {\r\n        margin: 0;\r\n      }\r\n      .geolocation {\r\n        margin: 0;\r\n      }\r\n    }\r\n    &.solo-img {\r\n      padding: 0;\r\n      border-radius: 1rem;\r\n    }\r\n    .geolocation {\r\n      display: flex;\r\n      align-items: flex-end;\r\n      justify-content: space-between;\r\n      height: 5.5rem;\r\n      width: 100%;\r\n      border-radius: 0.8rem;\r\n      margin: 0 0 0.4rem 0;\r\n      padding: 0 0.45rem 0.55rem 0.45rem;\r\n      background: center / cover no-repeat url(\"/img/hud/smartphone/messengerTab/chatSection/geolocationBg.png\");\r\n      &__info {\r\n        display: flex;\r\n        flex-direction: column;\r\n        font-size: 0.7rem;\r\n        margin: 0 0 0.2rem 0;\r\n        .desc {\r\n          color: #fff;\r\n          line-height: 0.9rem;\r\n          margin: 0 0 0.05rem 0;\r\n        }\r\n        .value {\r\n          color: #fff;\r\n          line-height: 0.8rem;\r\n          font-weight: 500;\r\n        }\r\n      }\r\n      &__btn {\r\n        width: 1.8rem;\r\n        height: 1.8rem;\r\n        border-radius: 0.5rem;\r\n        background: #fff;\r\n        box-shadow: 0px 0.5rem 1.5rem rgba(78, 110, 216, 0.3);\r\n        transition: all 0.15s;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        &::after {\r\n          content: \"\";\r\n          width: 0.8rem;\r\n          height: 0.8rem;\r\n          mask: center / cover no-repeat url(\"/img/hud/smartphone/messengerTab/chatSection/geoMark.svg\");\r\n          background: #4E6ED9;\r\n        }\r\n        &:hover {\r\n          box-shadow: none;\r\n        }\r\n      }\r\n    }\r\n    .img {\r\n      width: 100%;\r\n      height: auto;\r\n      border-radius: 0.8rem;\r\n      margin: 0 0 0.4rem 0;\r\n    }\r\n    .title {\r\n      font-size: 0.65rem;\r\n      line-height: 0.75rem;\r\n      color: #4E6ED9;\r\n      margin: 0 0 0.15rem 0;\r\n      padding: 0 0.6rem;\r\n    }\r\n    .text {\r\n      display: block;\r\n      padding: 0 0.6rem;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}