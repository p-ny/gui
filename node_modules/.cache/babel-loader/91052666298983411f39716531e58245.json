{"remainingRequest":"C:\\gta go\\Gui\\node_modules\\thread-loader\\dist\\cjs.js!C:\\gta go\\Gui\\node_modules\\babel-loader\\lib\\index.js!C:\\gta go\\Gui\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\gta go\\Gui\\src\\store\\smartphone\\modules\\message-page.js","dependencies":[{"path":"C:\\gta go\\Gui\\src\\store\\smartphone\\modules\\message-page.js","mtime":1629112495829},{"path":"C:\\gta go\\Gui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685190017390},{"path":"C:\\gta go\\Gui\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1685190017367},{"path":"C:\\gta go\\Gui\\node_modules\\babel-loader\\lib\\index.js","mtime":1685190019507},{"path":"C:\\gta go\\Gui\\node_modules\\eslint-loader\\index.js","mtime":1685190018634}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkM6L2d0YSBnby9HdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHsKICAgIG1lc3NlbmdlckRhdGE6IHsKICAgICAgQ3VycmVudEFjY291bnQ6IHsKICAgICAgICBJZDogLTEsCiAgICAgICAgVXNlcm5hbWU6ICdtaWx0JywKICAgICAgICBEaXNwbGF5ZWROYW1lOiAnbWF0dmV5JywKICAgICAgICBJc051bWJlckhpZGVkOiBmYWxzZQogICAgICB9LAogICAgICBTZWFyY2hTdWJzY3JpYmVyczogWy8vIHsgSWQ6IDAsIERpc3BsYXllZE5hbWU6ICdHYXkgTWFuJywgTGFzdFZpc2l0VGltZTogMjAzMzMxMjEyMzMyIH0KICAgICAgXSwKICAgICAgQ2hhdHM6IFsvLyB7IElkOiA4LCBOYW1lOiAnRmlyc3QgY2hhdDgnLCBJc09ubGluZTogdHJ1ZSwgVHlwZTogMCwgTm9uUmVhZE1lc3NhZ2VzQ291bnQ6IDAsCiAgICAgICAgLy8gTGFzdE1lc3NhZ2U6IHsgSWQ6IDAsIENoYXRJZDogMCwgVGV4dDogJ0hpISBXaG8gYXJlIHlvdT8nLCBUeXBlOiAwLAogICAgICAgIC8vIFRpbWU6IDE2MDMwMDUxMzIwMDAsIElzUmVhZDogZmFsc2UsIEFkbWluczogWwogICAgICAgIC8vICAgIHsgRGlzcGxheWVkTmFtZTogJ0dvbmRvbicsIElkOiAyLCBBZG1pbkx2bDogMiwgUGVybWlzc2lvbjogWzAsIDIsIDMsIDRdIH0gCiAgICAgICAgLy8gXSB9IH0sCiAgICAgIF0sCiAgICAgIENvbnRhY3RzOiBbLy8geyBJZDogMTIsIE5hbWU6ICfhg6Hhg5Dhg5zhg6Lhg5Thg6Xhg5zhg5jhg5nhg53hg6Hhg5gnLCBOdW1iZXI6IDg4MDA1NTQzNTM1LCBUaW1lOiAxMTMwNDQzMjAwMDAwLCBJc09ubGluZTogdHJ1ZSB9LAogICAgICBdLAogICAgICBfY2FjaGVkQWNjb3VudHM6IFsvLyB7IElkOiAwLCBEaXNwbGF5ZWROYW1lOiAn0YTQsNC60LHQvtC5JyB9CiAgICAgIF0sCiAgICAgIF9jYWNoZWRNZXNzYWdlczogW10sCiAgICAgIEN1cnJlbnRDaGF0OiB7CiAgICAgICAgSWQ6IDAsCiAgICAgICAgTmFtZTogJ1NKU0pGS1dQQ09FSlYgU0pFS1JJRkpBTkRMV1InLAogICAgICAgIElzT25saW5lOiBudWxsLAogICAgICAgIFR5cGU6IDAsCiAgICAgICAgSWNvbkNvbG9yczogJ2xpbmVhci1ncmFkaWVudCg5MGRlZywgIzQzRTk3QiAwJSwgIzM4RjlENyAxMDAlKScsCiAgICAgICAgU3Vic2NyaWJlcnNDb3VudDogMTIzLAogICAgICAgIEl0ZW1zOiBbLy8geyBJZDogMCwgQ2hhdElkOiAwLCBTZW5kZXJJZDogMCwgVGV4dDogJ0hpISBXaG8gYXJlIHlvdT8g8J+Yg/CfmIEnLCBBdHRhY2htZW50OiBudWxsICwgVGltZTogMTYwMzIwMjg5ODQ4MiwgSXNSZWFkOiB0cnVlIH0sCiAgICAgICAgICAvLyB7IElkOiAxLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAxLCBUZXh0OiAnSXRgcyBtZSwgbmlnZ2EsIGF5bycsIEF0dGFjaG1lbnQ6IHsgSWQ6IDEsIFR5cGU6IDIsIFVybDogJ2h0dHBzOi8vYzQud2FsbHBhcGVyZmxhcmUuY29tL3dhbGxwYXBlci81MDAvNDQyLzM1NC9vdXRydW4tdmFwb3J3YXZlLWhkLXdhbGxwYXBlci1wcmV2aWV3LmpwZycgfSwgVGltZTogMTYwMzIwMjg5ODQ4NywgSXNSZWFkOiB0cnVlIH0sCiAgICAgICAgICAvLyB7IElkOiAwLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAxLCBUZXh0OiAnJywgQXR0YWNobWVudDogeyBJZDogMSwgVHlwZTogMCwgR2VvTWFyazogeyBYOiAxMDAsIFk6IDEwMCwgWjogMTAwfSB9ICwgVGltZTogMTYwMzIwMjg5ODQ4MiwgSXNSZWFkOiB0cnVlIH0sCiAgICAgICAgICAvLyB7IElkOiAwLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAwLCBUZXh0OiAnJywgQXR0YWNobWVudDogeyBJZDogMSwgVHlwZTogMCwgR2VvTWFyazogeyBYOiAxMDAsIFk6IDEwMCwgWjogMTAwfSB9ICwgVGltZTogMTYwMzIwMjg5ODQ4MiwgSXNSZWFkOiB0cnVlIH0sCiAgICAgICAgICAvLyB7IElkOiAxLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAwLCBUZXh0OiAnJywgQXR0YWNobWVudDogeyBJZDogMSwgVHlwZTogMiwgVXJsOiAnaHR0cHM6Ly9jNC53YWxscGFwZXJmbGFyZS5jb20vd2FsbHBhcGVyLzUwMC80NDIvMzU0L291dHJ1bi12YXBvcndhdmUtaGQtd2FsbHBhcGVyLXByZXZpZXcuanBnJyB9LCBUaW1lOiAxNjAzMjAyODk4NDg3LCBJc1JlYWQ6IHRydWUgfSwKICAgICAgICAgIC8vIHsgSWQ6IDEsIENoYXRJZDogMCwgU2VuZGVySWQ6IDEsIFRleHQ6ICcnLCBBdHRhY2htZW50OiB7IElkOiAxLCBUeXBlOiAyLCBVcmw6ICdodHRwczovL2M0LndhbGxwYXBlcmZsYXJlLmNvbS93YWxscGFwZXIvNTAwLzQ0Mi8zNTQvb3V0cnVuLXZhcG9yd2F2ZS1oZC13YWxscGFwZXItcHJldmlldy5qcGcnIH0sIFRpbWU6IDE2MDMyMDI4OTg0ODcsIElzUmVhZDogdHJ1ZSB9LAogICAgICAgICAgLy8geyBJZDogMiwgQ2hhdElkOiAwLCBTZW5kZXJJZDogMiwgVGV4dDogJ01tbSwgb2suTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2snLCBUaW1lOiAxNjAzMzA4ODk4NDg3LCBJc1JlYWQ6IGZhbHNlIH0sCiAgICAgICAgICAvLyB7IElkOiAyLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAyLCBUZXh0OiAnTW1tLCBvay5NbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBvaycsIFRpbWU6IDE2MDMzMDg4OTg0ODcsIElzUmVhZDogZmFsc2UgfSwKICAgICAgICAgIC8vIHsgSWQ6IDIsIENoYXRJZDogMCwgU2VuZGVySWQ6IDIsIFRleHQ6ICdNbW0sIG9rLk1tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rJywgVGltZTogMTYwMzMwODg5ODQ4NywgSXNSZWFkOiBmYWxzZSB9LAogICAgICAgICAgLy8geyBJZDogMiwgQ2hhdElkOiAwLCBTZW5kZXJJZDogMiwgVGV4dDogJ01tbSwgb2suTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2snLCBUaW1lOiAxNjAzMzA4ODk4NDg3LCBJc1JlYWQ6IGZhbHNlIH0sCiAgICAgICAgICAvLyB7IElkOiAyLCBDaGF0SWQ6IDAsIFNlbmRlcklkOiAyLCBUZXh0OiAnTW1tLCBvay5NbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBva01tbSwgb2tNbW0sIG9rTW1tLCBvaycsIFRpbWU6IDE2MDMzMDg4OTg0ODcsIElzUmVhZDogZmFsc2UgfSwKICAgICAgICBdLAogICAgICAgIElzTG9hZGluZzogZmFsc2UKICAgICAgfSwKICAgICAgQ2FuYWxQcm9maWxlOiB7CiAgICAgICAgTmFtZTogJ9Ch0LDQvNGL0Lkg0LTQu9C40L3QvdGL0Lkg0L3QuNC6INCyINC40LPRgNC1JywKICAgICAgICBJc09ubGluZTogdHJ1ZSwKICAgICAgICBBZG1pbkx2bDogMiwKICAgICAgICBBYmlsaXRpZXM6IHsKICAgICAgICAgIGNoYW5nZVByb2ZpbGU6IHRydWUsCiAgICAgICAgICBjcmVhdGVQb3N0czogZmFsc2UsCiAgICAgICAgICBkZWxldGVQb3N0czogZmFsc2UsCiAgICAgICAgICBhcHBvaW50bWVudEFkbWluczogZmFsc2UKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpZXdlZFByb2ZpbGU6IHsKICAgICAgICBJZDogMSwKICAgICAgICBVc2VybmFtZTogJ3VzZXJuYW1lJywKICAgICAgICBEaXNwbGF5ZWROYW1lOiAn0KHQsNC80YvQuSDQtNC70LjQvdC90YvQuSDQvdC40Log0LIg0LjQs9GA0LUnLAogICAgICAgIE51bWJlcjogOTM5Mzk0LAogICAgICAgIElzTnVtYmVySGlkZWQ6IGZhbHNlLAogICAgICAgIElzTXV0ZWQ6IGZhbHNlLAogICAgICAgIElzQmxvY2tlZDogZmFsc2UsCiAgICAgICAgTGFzdFZpc2l0VGltZTogMTYwMzk1OTA3MTAwMCwKICAgICAgICBJc09ubGluZTogZmFsc2UsCiAgICAgICAgSXNJbkNvbnRhY3RzOiBmYWxzZSwKICAgICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICAgIH0KICAgIH0KICB9LAogIG11dGF0aW9uczogewogICAgc2V0TWVzc2VuZ2VyQ2FuYWxQcm9maWxlQWJpbGl0eTogZnVuY3Rpb24gc2V0TWVzc2VuZ2VyQ2FuYWxQcm9maWxlQWJpbGl0eShzdGF0ZSwgX3JlZikgewogICAgICB2YXIga2V5ID0gX3JlZi5rZXksCiAgICAgICAgICB2YWx1ZSA9IF9yZWYudmFsdWU7CiAgICAgIHZhciBjdXJyZW50Q2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQ7CiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGN1cnJlbnRDaGF0LklkOwogICAgICB9KTsKICAgICAgdmFyIGFkbWluID0gY2hhdC5BZG1pbnMuZmluZChmdW5jdGlvbiAoYSkgewogICAgICAgIHJldHVybiBhLklkID09PSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNhbmFsUHJvZmlsZS5JZDsKICAgICAgfSk7CgogICAgICBpZiAoYWRtaW4pIHsKICAgICAgICBpZiAodmFsdWUpIGFkbWluLlBlcm1pc3Npb25zLnB1c2goa2V5KTtlbHNlIHsKICAgICAgICAgIHZhciBpZHggPSBhZG1pbi5QZXJtaXNzaW9ucy5pbmRleE9mKGtleSk7CiAgICAgICAgICBpZiAoaWR4KSBhZG1pbi5QZXJtaXNzaW9ucy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGN1cnJlbnRDaGF0LkFkbWlucyA9IGNoYXQuQWRtaW5zOwogICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNhbmFsUHJvZmlsZS5QZXJtaXNzaW9ucyA9IGFkbWluLlBlcm1pc3Npb25zOwogICAgICB3aW5kb3cubXAudHJpZ2dlclNlcnZlcigncGhvbmU6Om1zZzo6bWFuYWdlOjpzZXRBY2NvdW50UGVybWlzc2lvbicsIGNoYXQuSWQsIGFkbWluLklkLCBrZXksIHZhbHVlKTsKICAgIH0sCiAgICBzZXRNZXNzZW5nZXJDdXJyZW50Q2hhdEljb25Db2xvcnM6IGZ1bmN0aW9uIHNldE1lc3NlbmdlckN1cnJlbnRDaGF0SWNvbkNvbG9ycyhzdGF0ZSwgdmFsdWUpIHsKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JY29uQ29sb3JzID0gdmFsdWU7CiAgICB9LAogICAgbXNnX3NldEFjY291bnRTZXR0aW5nczogZnVuY3Rpb24gbXNnX3NldEFjY291bnRTZXR0aW5ncyhzdGF0ZSwgYWNjb3VudFNldHRpbmdzKSB7CiAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudEFjY291bnQgPSBhY2NvdW50U2V0dGluZ3M7CiAgICB9LAogICAgLy8jcmVnaW9uIE1zZyBDb250YWN0cwogICAgbXNnX3NldFN1YnNjcmliZXJzRm9yU2VhcmNoOiBmdW5jdGlvbiBtc2dfc2V0U3Vic2NyaWJlcnNGb3JTZWFyY2goc3RhdGUsIHN1YnNjcmliZXJzKSB7CiAgICAgIHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmliZXIpIHsKICAgICAgICBpZiAoc3Vic2NyaWJlci5MYXN0VmlzaXRUaW1lKSBzdWJzY3JpYmVycy5MYXN0VmlzaXRUaW1lICo9IDEwMDA7CiAgICAgIH0pOwogICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLlNlYXJjaFN1YnNjcmliZXJzID0gc3Vic2NyaWJlcnM7CiAgICB9LAogICAgbXNnX2xvYWRDb250YWN0czogZnVuY3Rpb24gbXNnX2xvYWRDb250YWN0cyhzdGF0ZSwgY29udGFjdHMpIHsKICAgICAgY29udGFjdHMuZm9yRWFjaChmdW5jdGlvbiAoY29udGFjdCkgewogICAgICAgIGlmIChjb250YWN0LlRpbWUpIGNvbnRhY3QuVGltZSAqPSAxMDAwOwogICAgICAgIHZhciBvbGRDb250YWN0SW5kZXggPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNvbnRhY3RzLmZpbmRJbmRleChmdW5jdGlvbiAoYykgewogICAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNvbnRhY3QuSWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChvbGRDb250YWN0SW5kZXggPT09IC0xKSB7CiAgICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNvbnRhY3RzLnB1c2goY29udGFjdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ29udGFjdHNbb2xkQ29udGFjdEluZGV4XSA9IGNvbnRhY3Q7CiAgICAgICAgfQoKICAgICAgICB2YXIgcHJpdmF0ZUNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIHJldHVybiBjLkFjY291bnRJZCA9PT0gY29udGFjdC5BY2NvdW50SWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChwcml2YXRlQ2hhdCkgewogICAgICAgICAgcHJpdmF0ZUNoYXQuTmFtZSA9IGNvbnRhY3QuTmFtZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIG1zZ19yZW1vdmVTdG9yZUNvbnRhY3Q6IGZ1bmN0aW9uIG1zZ19yZW1vdmVTdG9yZUNvbnRhY3Qoc3RhdGUsIGNvbnRhY3RJZCkgewogICAgICB2YXIgY29udGFjdEluZGV4ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0cy5maW5kSW5kZXgoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gY29udGFjdElkOwogICAgICB9KTsKCiAgICAgIGlmIChjb250YWN0SW5kZXggIT09IC0xKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0cy5zcGxpY2UoY29udGFjdEluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIG1zZ19zZXRDb250YWN0SXNPbmxpbmU6IGZ1bmN0aW9uIG1zZ19zZXRDb250YWN0SXNPbmxpbmUoc3RhdGUsIF9yZWYyKSB7CiAgICAgIHZhciBjb250YWN0SWQgPSBfcmVmMi5jb250YWN0SWQsCiAgICAgICAgICBpc09ubGluZSA9IF9yZWYyLmlzT25saW5lOwogICAgICB2YXIgY29udGFjdEluZGV4ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0cy5maW5kSW5kZXgoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gY29udGFjdElkOwogICAgICB9KTsKCiAgICAgIGlmIChjb250YWN0SW5kZXggIT09IC0xKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0c1tjb250YWN0SW5kZXhdLklzT25saW5lID0gaXNPbmxpbmU7CiAgICAgIH0KICAgIH0sCiAgICAvLyNlbmRyZWdpb24gTXNnIENvbnRhY3RzCiAgICAvLyNyZWdpb24gTXNnIENoYXRzCiAgICBtc2dfbG9hZENoYXRzOiBmdW5jdGlvbiBtc2dfbG9hZENoYXRzKHN0YXRlLCBjaGF0cykgewogICAgICBjaGF0cy5mb3JFYWNoKGZ1bmN0aW9uIChjaGF0KSB7CiAgICAgICAgdmFyIF9jaGF0JExhc3RNZXNzYWdlJFRpbSwgX2NoYXQkTGFzdE1lc3NhZ2U7CgogICAgICAgIHZhciBjaGF0SW5kZXggPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmRJbmRleChmdW5jdGlvbiAoYykgewogICAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXQuSWQ7CiAgICAgICAgfSk7CiAgICAgICAgY2hhdC5BY3Rpb25UaW1lID0gKF9jaGF0JExhc3RNZXNzYWdlJFRpbSA9IChfY2hhdCRMYXN0TWVzc2FnZSA9IGNoYXQuTGFzdE1lc3NhZ2UpID09PSBudWxsIHx8IF9jaGF0JExhc3RNZXNzYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2hhdCRMYXN0TWVzc2FnZS5UaW1lKSAhPT0gbnVsbCAmJiBfY2hhdCRMYXN0TWVzc2FnZSRUaW0gIT09IHZvaWQgMCA/IF9jaGF0JExhc3RNZXNzYWdlJFRpbSA6IGNoYXQuQ3JlYXRlZFRpbWU7CiAgICAgICAgY2hhdC5BY3Rpb25UaW1lICo9IDEwMDA7CgogICAgICAgIGlmIChjaGF0SW5kZXggPT09IC0xKSB7CiAgICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLnB1c2goY2hhdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuc3BsaWNlKGNoYXRJbmRleCwgMSk7CiAgICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLnB1c2goY2hhdCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBtc2dfcmVtb3ZlQ2hhdDogZnVuY3Rpb24gbXNnX3JlbW92ZUNoYXQoc3RhdGUsIGNoYXRJZCkgewogICAgICB2YXIgY2hhdElkeCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZEluZGV4KGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXRJZDsKICAgICAgfSk7CgogICAgICBpZiAoY2hhdElkeCAhPT0gLTEpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLnNwbGljZShjaGF0SWR4LCAxKTsKICAgICAgfQogICAgfSwKICAgIG1zZ19jYWNoZU1lc3NhZ2U6IGZ1bmN0aW9uIG1zZ19jYWNoZU1lc3NhZ2Uoc3RhdGUsIG1lc3NhZ2UpIHsKICAgICAgdmFyIGNhY2hlZE1lc3NhZ2VJbmRleCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuX2NhY2hlZE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAobSkgewogICAgICAgIHJldHVybiBtLklkID09PSBtZXNzYWdlLklkOwogICAgICB9KTsKCiAgICAgIGlmIChjYWNoZWRNZXNzYWdlSW5kZXggPT09IC0xKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkTWVzc2FnZXMucHVzaChtZXNzYWdlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLl9jYWNoZWRNZXNzYWdlc1tjYWNoZWRNZXNzYWdlSW5kZXhdID0gbWVzc2FnZTsKICAgICAgfQogICAgfSwKICAgIG1zZ191bmNhY2hlTWVzc2FnZTogZnVuY3Rpb24gbXNnX3VuY2FjaGVNZXNzYWdlKHN0YXRlLCBtZXNzYWdlSWQpIHsKICAgICAgdmFyIGNhY2hlZE1lc3NhZ2VJbmRleCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuX2NhY2hlZE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAobSkgewogICAgICAgIHJldHVybiBtLklkID09PSBtZXNzYWdlSWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGNhY2hlZE1lc3NhZ2VJbmRleCAhPT0gLTEpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLl9jYWNoZWRNZXNzYWdlcy5zcGxpY2UoY2FjaGVkTWVzc2FnZUluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIG1zZ19tYXJrQ2hhdE1lc3NhZ2VzQXNSZWFkOiBmdW5jdGlvbiBtc2dfbWFya0NoYXRNZXNzYWdlc0FzUmVhZChzdGF0ZSwgY2hhdElkKSB7CiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXRJZDsKICAgICAgfSk7CgogICAgICBpZiAoY2hhdCkgewogICAgICAgIGNoYXQuTm9uUmVhZE1lc3NhZ2VzQ291bnQgPSAwOwogICAgICB9CiAgICB9LAogICAgbXNnX3NldE93bk1lc3NhZ2VzUmVhZEluQ2hhdDogZnVuY3Rpb24gbXNnX3NldE93bk1lc3NhZ2VzUmVhZEluQ2hhdChzdGF0ZSwgY2hhdElkKSB7CiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklkID09PSBjaGF0SWQpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0Lkl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKG0pIHsKICAgICAgICAgIGlmIChtLlNlbmRlcklkID09PSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRBY2NvdW50LklkKSB7CiAgICAgICAgICAgIG0uSXNSZWFkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkTWVzc2FnZXMuZm9yRWFjaChmdW5jdGlvbiAobSkgewogICAgICAgIGlmIChtLlNlbmRlcklkID09PSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRBY2NvdW50LklkKSB7CiAgICAgICAgICBtLklzUmVhZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBtc2dfc2V0TGFzdE1lc3NhZ2U6IGZ1bmN0aW9uIG1zZ19zZXRMYXN0TWVzc2FnZShzdGF0ZSwgbWVzc2FnZSkgewogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBtZXNzYWdlLkNoYXRJZDsKICAgICAgfSk7CgogICAgICBpZiAoY2hhdCkgewogICAgICAgIGNoYXQuTGFzdE1lc3NhZ2UgPSBtZXNzYWdlOwogICAgICAgIGNoYXQuQWN0aW9uVGltZSA9IG1lc3NhZ2UuVGltZTsKICAgICAgfQogICAgfSwKICAgIG1zZ19zZXRDdXJyZW50Q2hhdElzTG9hZGluZzogZnVuY3Rpb24gbXNnX3NldEN1cnJlbnRDaGF0SXNMb2FkaW5nKHN0YXRlLCB0b2dnbGUpIHsKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5Jc0xvYWRpbmcgPSB0b2dnbGU7CiAgICB9LAogICAgbXNnX3NldEN1cnJlbnRDaGF0TWVzc2FnZXM6IGZ1bmN0aW9uIG1zZ19zZXRDdXJyZW50Q2hhdE1lc3NhZ2VzKHN0YXRlLCBtZXNzYWdlcykgewogICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0Lkl0ZW1zID0gbWVzc2FnZXM7CiAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSXNMb2FkaW5nID0gZmFsc2U7CiAgICB9LAogICAgbXNnX3NldEN1cnJlbnRDaGF0OiBmdW5jdGlvbiBtc2dfc2V0Q3VycmVudENoYXQoc3RhdGUsIF9yZWYzKSB7CiAgICAgIHZhciBJZCA9IF9yZWYzLklkLAogICAgICAgICAgTmFtZSA9IF9yZWYzLk5hbWUsCiAgICAgICAgICBJc09ubGluZSA9IF9yZWYzLklzT25saW5lLAogICAgICAgICAgVHlwZSA9IF9yZWYzLlR5cGUsCiAgICAgICAgICBTdWJzY3JpYmVyc0NvdW50ID0gX3JlZjMuU3Vic2NyaWJlcnNDb3VudCwKICAgICAgICAgIEFjY291bnRJZCA9IF9yZWYzLkFjY291bnRJZCwKICAgICAgICAgIEljb25Db2xvcnMgPSBfcmVmMy5JY29uQ29sb3JzLAogICAgICAgICAgUGVybWlzc2lvbnMgPSBfcmVmMy5QZXJtaXNzaW9ucywKICAgICAgICAgIERlc2NyaXB0aW9uID0gX3JlZjMuRGVzY3JpcHRpb24sCiAgICAgICAgICBBZG1pbkx2bCA9IF9yZWYzLkFkbWluTHZsLAogICAgICAgICAgSW52aXRlQ29kZSA9IF9yZWYzLkludml0ZUNvZGUsCiAgICAgICAgICBBZG1pbnMgPSBfcmVmMy5BZG1pbnMsCiAgICAgICAgICBCbG9ja0l0ZW1zID0gX3JlZjMuQmxvY2tJdGVtczsKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdCA9IHsKICAgICAgICBJZDogSWQsCiAgICAgICAgTmFtZTogTmFtZSwKICAgICAgICBJc09ubGluZTogSXNPbmxpbmUsCiAgICAgICAgVHlwZTogVHlwZSwKICAgICAgICBBZG1pbkx2bDogQWRtaW5MdmwsCiAgICAgICAgRGVzY3JpcHRpb246IERlc2NyaXB0aW9uLAogICAgICAgIFN1YnNjcmliZXJzQ291bnQ6IFN1YnNjcmliZXJzQ291bnQsCiAgICAgICAgSW52aXRlQ29kZTogSW52aXRlQ29kZSwKICAgICAgICBBZG1pbnM6IEFkbWlucywKICAgICAgICBCbG9ja0l0ZW1zOiBCbG9ja0l0ZW1zCiAgICAgIH07IC8vIENoYW5uZWwgYW5kIGdyb3VwIGNoYXRzIGZpZWxkcwoKICAgICAgaWYgKFBlcm1pc3Npb25zKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5DYW5DaGFuZ2luZ0dyb3VwUHJvZmlsZSA9IFBlcm1pc3Npb25zLmluY2x1ZGVzKDEpOwogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuQ2FuRGVsZXRpbmdNZXNzYWdlcyA9IFBlcm1pc3Npb25zLmluY2x1ZGVzKDIpOwogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuQ2FuQmxvY2tpbmdBY2NvdW50cyA9IFBlcm1pc3Npb25zLmluY2x1ZGVzKDMpOwogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuQ2FuUHVycG9zaW5nQWRtaW5zID0gUGVybWlzc2lvbnMuaW5jbHVkZXMoNCk7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5DYW5DcmVhdGluZ1Bvc3RzID0gUGVybWlzc2lvbnMuaW5jbHVkZXMoNSk7CiAgICAgIH0KCiAgICAgIGlmIChJY29uQ29sb3JzKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JY29uQ29sb3JzID0gSWNvbkNvbG9yczsKICAgICAgfSAvLyBQcml2YXRlIGNoYXRzIGZpZWxkCgoKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5BY2NvdW50SWQgPSBBY2NvdW50SWQ7CiAgICB9LAogICAgbXNnX2xvYWRBY2NvdW50czogZnVuY3Rpb24gbXNnX2xvYWRBY2NvdW50cyhzdGF0ZSwgYWNjb3VudHMpIHsKICAgICAgYWNjb3VudHMuZm9yRWFjaChmdW5jdGlvbiAoYWNjb3VudCkgewogICAgICAgIHZhciBjb250YWN0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICByZXR1cm4gYy5BY2NvdW50SWQgPT09IGFjY291bnQuSWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChjb250YWN0KSB7CiAgICAgICAgICBhY2NvdW50LkRpc3BsYXllZE5hbWUgPSBjb250YWN0Lk5hbWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgYWNjb3VudEluZGV4ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkQWNjb3VudHMuZmluZEluZGV4KGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICByZXR1cm4gYS5JZCA9PSBhY2NvdW50LklkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoYWNjb3VudEluZGV4ID09PSAtMSkgewogICAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkQWNjb3VudHMucHVzaChhY2NvdW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkQWNjb3VudHNbYWNjb3VudEluZGV4XSA9IGFjY291bnQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBtc2dfc2V0Q2hhdE11dGVkOiBmdW5jdGlvbiBtc2dfc2V0Q2hhdE11dGVkKHN0YXRlLCBfcmVmNCkgewogICAgICB2YXIgQ2hhdElkID0gX3JlZjQuQ2hhdElkLAogICAgICAgICAgSXNNdXRlZCA9IF9yZWY0LklzTXV0ZWQ7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gQ2hhdElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5Jc011dGVkID0gSXNNdXRlZDsKICAgICAgfQoKICAgICAgdmFyIGNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ2hhdElkOwogICAgICB9KTsKCiAgICAgIGlmIChjaGF0KSB7CiAgICAgICAgY2hhdC5Jc011dGVkID0gSXNNdXRlZDsKICAgICAgfQogICAgfSwKICAgIG1zZ19yZW5hbWVDaGF0OiBmdW5jdGlvbiBtc2dfcmVuYW1lQ2hhdChzdGF0ZSwgX3JlZjUpIHsKICAgICAgdmFyIENoYXRJZCA9IF9yZWY1LkNoYXRJZCwKICAgICAgICAgIE5hbWUgPSBfcmVmNS5OYW1lOwogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBDaGF0SWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGNoYXQpIHsKICAgICAgICBjaGF0Lk5hbWUgPSBOYW1lOwogICAgICB9CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gQ2hhdElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5OYW1lID0gTmFtZTsKICAgICAgfQogICAgfSwKICAgIG1zZ19pbmNyZWFzZVN1YnNjcmliZXJzQ291bnQ6IGZ1bmN0aW9uIG1zZ19pbmNyZWFzZVN1YnNjcmliZXJzQ291bnQoc3RhdGUsIGNoYXRJZCkgewogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gY2hhdElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5TdWJzY3JpYmVyc0NvdW50Kys7CiAgICAgIH0KCiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXRJZDsKICAgICAgfSk7CgogICAgICBpZiAoY2hhdCkgewogICAgICAgIGlmICghY2hhdC5TdWJzY3JpYmVyc0NvdW50KSB7CiAgICAgICAgICBjaGF0LlN1YnNjcmliZXJzQ291bnQgPSAwOwogICAgICAgIH0KCiAgICAgICAgY2hhdC5TdWJzY3JpYmVyc0NvdW50Kys7CiAgICAgIH0KICAgIH0sCiAgICBtc2dfZGVjcmVhc2VTdWJzY3JpYmVyc0NvdW50OiBmdW5jdGlvbiBtc2dfZGVjcmVhc2VTdWJzY3JpYmVyc0NvdW50KHN0YXRlLCBjaGF0SWQpIHsKICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSWQgPT09IGNoYXRJZCkgewogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuU3Vic2NyaWJlcnNDb3VudC0tOwogICAgICB9CgogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBjaGF0SWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGNoYXQpIHsKICAgICAgICBpZiAoIWNoYXQuU3Vic2NyaWJlcnNDb3VudCkgewogICAgICAgICAgY2hhdC5TdWJzY3JpYmVyc0NvdW50ID0gMDsKICAgICAgICB9CgogICAgICAgIGNoYXQuU3Vic2NyaWJlcnNDb3VudC0tOwogICAgICB9CiAgICB9LAogICAgbXNnX3JlbW92ZUZyb21CbG9ja2xpc3Q6IGZ1bmN0aW9uIG1zZ19yZW1vdmVGcm9tQmxvY2tsaXN0KHN0YXRlLCBfcmVmNikgewogICAgICB2YXIgQ2hhdElkID0gX3JlZjYuQ2hhdElkLAogICAgICAgICAgQWNjb3VudElkID0gX3JlZjYuQWNjb3VudElkOwogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBDaGF0SWQ7CiAgICAgIH0pOwogICAgICBpZiAoIWNoYXQpIHJldHVybjsKICAgICAgdmFyIGJsb2NrSWR4ID0gY2hhdC5CbG9ja0l0ZW1zLmZpbmRJbmRleChmdW5jdGlvbiAoYikgewogICAgICAgIHJldHVybiBiLkFjY291bnRJZCA9PT0gQWNjb3VudElkOwogICAgICB9KTsKICAgICAgaWYgKGJsb2NrSWR4ID09PSAtMSkgcmV0dXJuOwogICAgICBjaGF0LkJsb2NrSXRlbXMuc3BsaWNlKGJsb2NrSWR4LCAxKTsKCiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklkID09PSBDaGF0SWQpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LkJsb2NrSXRlbXMgPSBjaGF0LkJsb2NrSXRlbXM7CiAgICAgIH0KICAgIH0sCiAgICBtc2dfYWRkQmxvY2tsaXN0SXRlbXM6IGZ1bmN0aW9uIG1zZ19hZGRCbG9ja2xpc3RJdGVtcyhzdGF0ZSwgX3JlZjcpIHsKICAgICAgdmFyIENoYXRJZCA9IF9yZWY3LkNoYXRJZCwKICAgICAgICAgIEJsb2NrSXRlbXMgPSBfcmVmNy5CbG9ja0l0ZW1zOwogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBDaGF0SWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGNoYXQpIHsKICAgICAgICBpZiAoIWNoYXQuQmxvY2tJdGVtcykgY2hhdC5CbG9ja0l0ZW1zID0gW107CiAgICAgICAgQmxvY2tJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICBpZiAoIWNoYXQuQmxvY2tJdGVtcy5maW5kKGZ1bmN0aW9uIChiaSkgewogICAgICAgICAgICByZXR1cm4gYmkuSWQgPT09IGkuSWQ7CiAgICAgICAgICB9KSkgewogICAgICAgICAgICBjaGF0LkJsb2NrSXRlbXMucHVzaChpKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSWQgPT09IENoYXRJZCkgewogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuQmxvY2tJdGVtcyA9IGNoYXQuQmxvY2tJdGVtczsKICAgICAgfQogICAgfSwKICAgIG1zZ19zZXRDaGF0SXNPbmxpbmU6IGZ1bmN0aW9uIG1zZ19zZXRDaGF0SXNPbmxpbmUoc3RhdGUsIF9yZWY4KSB7CiAgICAgIHZhciBDaGF0SWQgPSBfcmVmOC5DaGF0SWQsCiAgICAgICAgICBJc09ubGluZSA9IF9yZWY4LklzT25saW5lOwogICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLklkID09PSBDaGF0SWQ7CiAgICAgIH0pOwoKICAgICAgaWYgKGNoYXQpIHsKICAgICAgICBjaGF0LklzT25saW5lID0gSXNPbmxpbmU7CiAgICAgIH0KCiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklkID09PSBDaGF0SWQpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklzT25saW5lID0gY2hhdC5Jc09ubGluZTsKICAgICAgfQogICAgfSwKICAgIC8vI2VuZHJlZ2lvbiBNc2cgQ2hhdHMKICAgIG1zZ19zZXRWaWV3ZWRQcm9maWxlSW5mbzogZnVuY3Rpb24gbXNnX3NldFZpZXdlZFByb2ZpbGVJbmZvKHN0YXRlLCBpbmZvKSB7CiAgICAgIGluZm8uSXNJbkNvbnRhY3RzID0gZmFsc2U7CiAgICAgIHZhciBjb250YWN0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5Db250YWN0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuQWNjb3VudElkID09PSBpbmZvLklkOwogICAgICB9KTsKCiAgICAgIGlmIChjb250YWN0KSB7CiAgICAgICAgaW5mby5EaXNwbGF5ZWROYW1lID0gY29udGFjdC5OYW1lOwogICAgICAgIGluZm8uSXNJbkNvbnRhY3RzID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaW5mby5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgaW5mby5MYXN0VmlzaXRUaW1lICo9IDEwMDA7CiAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZSA9IGluZm87CiAgICB9LAogICAgbXNnX3NldEFjY291bnREaXNwbGF5ZWROYW1lOiBmdW5jdGlvbiBtc2dfc2V0QWNjb3VudERpc3BsYXllZE5hbWUoc3RhdGUsIF9yZWY5KSB7CiAgICAgIHZhciBuZXdEaXNwbGF5ZWROYW1lID0gX3JlZjkubmV3RGlzcGxheWVkTmFtZTsKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50QWNjb3VudC5EaXNwbGF5ZWROYW1lID0gbmV3RGlzcGxheWVkTmFtZTsKICAgIH0sCiAgICBtc2dfc2V0QWNjb3VudElzTnVtYmVySGlkZWQ6IGZ1bmN0aW9uIG1zZ19zZXRBY2NvdW50SXNOdW1iZXJIaWRlZChzdGF0ZSwgaXNOdW1iZXJIaWRlZCkgewogICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRBY2NvdW50LklzTnVtYmVySGlkZWQgPSBpc051bWJlckhpZGVkOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgY2hlY2tDaGF0SXNMb2FkaW5nOiBmdW5jdGlvbiBjaGVja0NoYXRJc0xvYWRpbmcoX3JlZjEwKSB7CiAgICAgIHZhciBzdGF0ZSA9IF9yZWYxMC5zdGF0ZSwKICAgICAgICAgIGRpc3BhdGNoID0gX3JlZjEwLmRpc3BhdGNoOwoKICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSXNMb2FkaW5nKSB7CiAgICAgICAgZGlzcGF0Y2goJ3NtYXJ0cGhvbmUvc2V0VGFiT3JCYWNrJywgewogICAgICAgICAga2V5OiAnTWVzc2VuZ2VyVGFiJywKICAgICAgICAgIHNlY3Rpb246ICdHZW5lcmFsU2VjdGlvbicsCiAgICAgICAgICBzdWJzZWN0aW9uOiAnR2VuZXJhbFN1YnNlY3Rpb24nLAogICAgICAgICAgZGF0YTogbnVsbAogICAgICAgIH0sIHsKICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICB9KTsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklzTG9hZGluZyA9IGZhbHNlOwogICAgICB9IGVsc2UgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZS5Jc0xvYWRpbmcpIHsKICAgICAgICBkaXNwYXRjaCgnc21hcnRwaG9uZS9zZXRUYWJPckJhY2snLCB7CiAgICAgICAgICBrZXk6ICdNZXNzZW5nZXJUYWInLAogICAgICAgICAgc2VjdGlvbjogJ0dlbmVyYWxTZWN0aW9uJywKICAgICAgICAgIHN1YnNlY3Rpb246ICdHZW5lcmFsU3Vic2VjdGlvbicsCiAgICAgICAgICBkYXRhOiBudWxsCiAgICAgICAgfSwgewogICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZS5Jc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIG1zZ19kcm9wQ3VycmVudENoYXQ6IGZ1bmN0aW9uIG1zZ19kcm9wQ3VycmVudENoYXQoX3JlZjExKSB7CiAgICAgIHZhciBzdGF0ZSA9IF9yZWYxMS5zdGF0ZTsKICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9IC0xOwogICAgfSwKICAgIG1zZ19zZXRBZG1pbnNGb3JDdXJyZW50Q2hhdDogZnVuY3Rpb24gbXNnX3NldEFkbWluc0ZvckN1cnJlbnRDaGF0KF9yZWYxMiwgYWRtaW5zKSB7CiAgICAgIHZhciBzdGF0ZSA9IF9yZWYxMi5zdGF0ZTsKICAgICAgdmFyIGNoYXRJZCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSWQ7CiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXRJZDsKICAgICAgfSk7CgogICAgICBpZiAoIWNoYXQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuQWRtaW5zID0gYWRtaW5zOwogICAgICBjaGF0LkFkbWlucyA9IGFkbWluczsKICAgIH0sCiAgICBtc2dfYWRkQWRtaW5Gb3JDaGF0OiBmdW5jdGlvbiBtc2dfYWRkQWRtaW5Gb3JDaGF0KF9yZWYxMywgX3JlZjE0KSB7CiAgICAgIHZhciBzdGF0ZSA9IF9yZWYxMy5zdGF0ZTsKICAgICAgdmFyIENoYXRJZCA9IF9yZWYxNC5DaGF0SWQsCiAgICAgICAgICBBY2NvdW50SWQgPSBfcmVmMTQuQWNjb3VudElkOwogICAgICB2YXIgc3Vic2NyaWJlciA9IHN0YXRlLm1lc3NlbmdlckRhdGEuU2VhcmNoU3Vic2NyaWJlcnMuZmluZChmdW5jdGlvbiAocykgewogICAgICAgIHJldHVybiBzLklkID09PSBBY2NvdW50SWQ7CiAgICAgIH0pOwogICAgICBpZiAoIXN1YnNjcmliZXIpIHJldHVybjsKICAgICAgdmFyIGNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ2hhdElkOwogICAgICB9KTsKICAgICAgaWYgKCFjaGF0KSByZXR1cm47CiAgICAgIHN1YnNjcmliZXIuQWRtaW5MdmwgPSAxOwogICAgICBzdWJzY3JpYmVyLlBlcm1pc3Npb25zID0gW107CiAgICAgIGNoYXQuQWRtaW5zLnB1c2goc3Vic2NyaWJlcik7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gQ2hhdElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5BZG1pbnMucHVzaChzdWJzY3JpYmVyKTsKICAgICAgfQogICAgfSwKICAgIG1zZ19kZWxldGVBZG1pbkZvckNoYXQ6IGZ1bmN0aW9uIG1zZ19kZWxldGVBZG1pbkZvckNoYXQoX3JlZjE1LCBfcmVmMTYpIHsKICAgICAgdmFyIHN0YXRlID0gX3JlZjE1LnN0YXRlOwogICAgICB2YXIgQ2hhdElkID0gX3JlZjE2LkNoYXRJZCwKICAgICAgICAgIEFkbWluSWQgPSBfcmVmMTYuQWRtaW5JZDsKICAgICAgdmFyIGNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ2hhdElkOwogICAgICB9KTsKICAgICAgaWYgKCFjaGF0KSByZXR1cm47CiAgICAgIHZhciBhZG1pbklkeCA9IGNoYXQuQWRtaW5zLmZpbmRJbmRleChmdW5jdGlvbiAoYSkgewogICAgICAgIHJldHVybiBhLklkID09PSBBZG1pbklkOwogICAgICB9KTsKCiAgICAgIGlmIChhZG1pbklkeCAhPT0gLTEpIHsKICAgICAgICBjaGF0LkFkbWlucy5zcGxpY2UoYWRtaW5JZHgsIDEpOwogICAgICB9CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gQ2hhdElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5BZG1pbnMgPSBjaGF0LkFkbWluczsKICAgICAgfQogICAgfSwKICAgIG1zZ19zZXRNeUFkbWluUGVybWlzc2lvbnNGb3JDaGF0OiBmdW5jdGlvbiBtc2dfc2V0TXlBZG1pblBlcm1pc3Npb25zRm9yQ2hhdChfcmVmMTcsIF9yZWYxOCkgewogICAgICB2YXIgc3RhdGUgPSBfcmVmMTcuc3RhdGU7CiAgICAgIHZhciBDaGF0SWQgPSBfcmVmMTguQ2hhdElkLAogICAgICAgICAgQWRtaW5MdmwgPSBfcmVmMTguQWRtaW5MdmwsCiAgICAgICAgICBQZXJtaXNzaW9ucyA9IF9yZWYxOC5QZXJtaXNzaW9uczsKICAgICAgdmFyIGNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ2hhdElkOwogICAgICB9KTsKICAgICAgaWYgKCFjaGF0KSByZXR1cm47CiAgICAgIGNoYXQuUGVybWlzc2lvbnMgPSBQZXJtaXNzaW9uczsKICAgICAgY2hhdC5BZG1pbkx2bCA9IEFkbWluTHZsOwogICAgfSwKICAgIG1zZ19vcGVuQ2hhdDogZnVuY3Rpb24gbXNnX29wZW5DaGF0KF9yZWYxOSwgY2hhdElkKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMTkuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMTkuc3RhdGU7CiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IGNoYXRJZDsKICAgICAgfSk7CiAgICAgIHZhciBzdWJzZWN0aW9uc0J5Q2hhdFR5cGUgPSB7CiAgICAgICAgMDogJ1ByaXZhdGVTdWJzZWN0aW9uJywKICAgICAgICAxOiAnR3JvdXBTdWJzZWN0aW9uJywKICAgICAgICAyOiAnQ2FuYWxTdWJzZWN0aW9uJwogICAgICB9OwogICAgICBjb21taXQoJ21zZ19zZXRDdXJyZW50Q2hhdCcsIGNoYXQpOyAvLyBJc0FscmVhZHlMb2FkZWQgLSDRgyDQuNCz0YDQvtC60LAg0YPQttC1INC/0L7QtNCz0YDRg9C20LXQvdGLINC/0L7RgdC70LXQtNC90LjQtSDRgdC+0L7QsdGJ0LXQvdC40Y8g0LIg0YfQsNGC0LUKCiAgICAgIGlmIChjaGF0LklzQWxyZWFkeUxvYWRlZCkgewogICAgICAgIHZhciBtZXNzYWdlcyA9IHN0YXRlLm1lc3NlbmdlckRhdGEuX2NhY2hlZE1lc3NhZ2VzLmZpbHRlcihmdW5jdGlvbiAobSkgewogICAgICAgICAgcmV0dXJuIG0uQ2hhdElkID09PSBjaGF0SWQ7CiAgICAgICAgfSk7CgogICAgICAgIGNvbW1pdCgnbXNnX3NldEN1cnJlbnRDaGF0TWVzc2FnZXMnLCBtZXNzYWdlcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2luZG93Lm1wLnRyaWdnZXJTZXJ2ZXIoJ3Bob25lOjptc2c6OnJlcXVlc3RDaGF0JywgY2hhdElkKTsKICAgICAgICBjb21taXQoJ21zZ19zZXRDdXJyZW50Q2hhdElzTG9hZGluZycsIHRydWUpOwogICAgICB9CgogICAgICBjb21taXQoJ3NtYXJ0cGhvbmUvc2V0Q3VycmVudFRhYicsIHsKICAgICAgICBrZXk6ICdNZXNzZW5nZXJUYWInLAogICAgICAgIHNlY3Rpb246ICdDaGF0U2VjdGlvbicsCiAgICAgICAgc3Vic2VjdGlvbjogc3Vic2VjdGlvbnNCeUNoYXRUeXBlW2NoYXQuVHlwZV0sCiAgICAgICAgZGF0YTogbnVsbAogICAgICB9LCB7CiAgICAgICAgcm9vdDogdHJ1ZQogICAgICB9KTsKCiAgICAgIGlmIChjaGF0Lk5vblJlYWRNZXNzYWdlc0NvdW50ID4gMCkgewogICAgICAgIHdpbmRvdy5tcC50cmlnZ2VyU2VydmVyKCdwaG9uZTo6bXNnOjptYXJrQXNSZWFkJywgY2hhdElkKTsKICAgICAgfQogICAgfSwKICAgIG1zZ19vcGVuUHJpdmF0ZUNoYXQ6IGZ1bmN0aW9uIG1zZ19vcGVuUHJpdmF0ZUNoYXQoX3JlZjIwLCBhY2NvdW50SWQpIHsKICAgICAgdmFyIGRpc3BhdGNoID0gX3JlZjIwLmRpc3BhdGNoLAogICAgICAgICAgY29tbWl0ID0gX3JlZjIwLmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjIwLnN0YXRlOwogICAgICB2YXIgcHJpdmF0ZUNoYXQgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNoYXRzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5BY2NvdW50SWQgPT09IGFjY291bnRJZDsKICAgICAgfSk7CgogICAgICBpZiAocHJpdmF0ZUNoYXQpIHsKICAgICAgICBkaXNwYXRjaCgnbXNnX29wZW5DaGF0JywgcHJpdmF0ZUNoYXQuSWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbW1pdCgnbXNnX3NldEN1cnJlbnRDaGF0SXNMb2FkaW5nJywgdHJ1ZSk7CiAgICAgICAgY29tbWl0KCdtc2dfc2V0Q3VycmVudENoYXQnLCB7CiAgICAgICAgICBJZDogLTEsCiAgICAgICAgICBOYW1lOiAnUHJpdmF0ZSBDaGF0JywKICAgICAgICAgIElzT25saW5lOiBmYWxzZSwKICAgICAgICAgIFR5cGU6IDAsCiAgICAgICAgICBBY2NvdW50SWQ6IGFjY291bnRJZAogICAgICAgIH0pOwogICAgICAgIHdpbmRvdy5tcC50cmlnZ2VyU2VydmVyKCdwaG9uZTo6bXNnOjpjcmVhdGVQcml2YXRlQ2hhdCcsIGFjY291bnRJZCk7CiAgICAgICAgY29tbWl0KCdzbWFydHBob25lL3NldEN1cnJlbnRUYWInLCB7CiAgICAgICAgICBrZXk6ICdNZXNzZW5nZXJUYWInLAogICAgICAgICAgc2VjdGlvbjogJ0NoYXRTZWN0aW9uJywKICAgICAgICAgIHN1YnNlY3Rpb246ICdQcml2YXRlU3Vic2VjdGlvbicsCiAgICAgICAgICBkYXRhOiBudWxsCiAgICAgICAgfSwgewogICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgbXNnX2xvYWRJbmNoYXRJbmZvOiBmdW5jdGlvbiBtc2dfbG9hZEluY2hhdEluZm8oX3JlZjIxLCBfcmVmMjIpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYyMS5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYyMS5zdGF0ZTsKICAgICAgdmFyIENoYXRJZCA9IF9yZWYyMi5DaGF0SWQsCiAgICAgICAgICBTdWJzY3JpYmVyc0NvdW50ID0gX3JlZjIyLlN1YnNjcmliZXJzQ291bnQsCiAgICAgICAgICBNZXNzYWdlcyA9IF9yZWYyMi5NZXNzYWdlcywKICAgICAgICAgIFBlcm1pc3Npb25zID0gX3JlZjIyLlBlcm1pc3Npb25zLAogICAgICAgICAgQWRtaW5MdmwgPSBfcmVmMjIuQWRtaW5MdmwsCiAgICAgICAgICBJbnZpdGVDb2RlID0gX3JlZjIyLkludml0ZUNvZGU7CiAgICAgIE1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgICAgICBtZXNzYWdlLlRpbWUgKj0gMTAwMDsKICAgICAgICBtZXNzYWdlLkNoYXRJZCA9IENoYXRJZDsKICAgICAgICBjb21taXQoJ21zZ19jYWNoZU1lc3NhZ2UnLCBtZXNzYWdlKTsKICAgICAgfSk7CiAgICAgIHZhciBjaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGMuSWQgPT09IENoYXRJZDsKICAgICAgfSk7CiAgICAgIGNoYXQuU3Vic2NyaWJlcnNDb3VudCA9IFN1YnNjcmliZXJzQ291bnQ7CiAgICAgIGNoYXQuUGVybWlzc2lvbnMgPSBQZXJtaXNzaW9uczsKICAgICAgY2hhdC5Jc0FscmVhZHlMb2FkZWQgPSB0cnVlOwogICAgICBjaGF0LkFkbWluTHZsID0gQWRtaW5Mdmw7CiAgICAgIGNoYXQuSW52aXRlQ29kZSA9IEludml0ZUNvZGU7CiAgICAgIGNvbW1pdCgnbXNnX3NldEN1cnJlbnRDaGF0JywgY2hhdCk7CiAgICAgIGNvbW1pdCgnbXNnX3NldEN1cnJlbnRDaGF0TWVzc2FnZXMnLCBNZXNzYWdlcyk7IC8vINCf0L7QtNCz0YDRg9C30LrQsCDQvdC10LfQsNC60LXRiNC40YDQvtCy0LDQvdC90YvRhSDQsNC60LrQsNGD0L3RgtC+0LIKCiAgICAgIHZhciBzZW5kZXJzSWRzID0gX3RvQ29uc3VtYWJsZUFycmF5KG5ldyBTZXQoTWVzc2FnZXMubWFwKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgcmV0dXJuIG0uU2VuZGVySWQ7CiAgICAgIH0pKSk7CgogICAgICB2YXIgbm9uQ2FjaGVkQWNjb3VudHNJZHMgPSBzZW5kZXJzSWRzLmZpbHRlcihmdW5jdGlvbiAoYWNjb3VudElkKSB7CiAgICAgICAgcmV0dXJuICFzdGF0ZS5tZXNzZW5nZXJEYXRhLl9jYWNoZWRBY2NvdW50cy5maW5kKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICByZXR1cm4gYS5JZCA9PT0gYWNjb3VudElkOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgd2luZG93Lm1wLnRyaWdnZXJTZXJ2ZXIoJ3Bob25lOjptc2c6OnJlcXVlc3RBY2NvdW50c05hbWVzJywgSlNPTi5zdHJpbmdpZnkobm9uQ2FjaGVkQWNjb3VudHNJZHMpKTsKICAgIH0sCiAgICBtc2dfb3BlbkFjY291bnQ6IGZ1bmN0aW9uIG1zZ19vcGVuQWNjb3VudChfcmVmMjMsIGFjY291bnRJZCkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIzLmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjIzLnN0YXRlOwogICAgICB2YXIgY29udGFjdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ29udGFjdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLkFjY291bnRJZCA9PT0gYWNjb3VudElkOwogICAgICB9KTsKCiAgICAgIGlmIChjb250YWN0KSB7CiAgICAgICAgY29uc29sZS5sb2coIiIuY29uY2F0KGFjY291bnRJZCkpOwogICAgICB9CgogICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLnZpZXdlZFByb2ZpbGUuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgd2luZG93Lm1wLnRyaWdnZXJTZXJ2ZXIoJ3Bob25lOjptc2c6OnJlcXVlc3RBY2NvdW50JywgYWNjb3VudElkKTsKICAgICAgY29tbWl0KCdzbWFydHBob25lL3NldEN1cnJlbnRUYWInLCB7CiAgICAgICAga2V5OiAnTWVzc2VuZ2VyVGFiJywKICAgICAgICBzZWN0aW9uOiAnVmlld2VkUHJvZmlsZVNlY3Rpb24nLAogICAgICAgIGRhdGE6IG51bGwKICAgICAgfSwgewogICAgICAgIHJvb3Q6IHRydWUKICAgICAgfSk7CiAgICB9LAogICAgbXNnX3NldEFjY291bnRBbmRDaGF0TXV0ZWQ6IGZ1bmN0aW9uIG1zZ19zZXRBY2NvdW50QW5kQ2hhdE11dGVkKF9yZWYyNCwgX3JlZjI1KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMjQuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMjQuc3RhdGU7CiAgICAgIHZhciBDaGF0SWQgPSBfcmVmMjUuQ2hhdElkLAogICAgICAgICAgQWNjb3VudElkID0gX3JlZjI1LkFjY291bnRJZCwKICAgICAgICAgIElzTXV0ZWQgPSBfcmVmMjUuSXNNdXRlZDsKICAgICAgY29tbWl0KCdtc2dfc2V0Q2hhdE11dGVkJywgewogICAgICAgIENoYXRJZDogQ2hhdElkLAogICAgICAgIElzTXV0ZWQ6IElzTXV0ZWQKICAgICAgfSk7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS52aWV3ZWRQcm9maWxlLklkID09PSBBY2NvdW50SWQpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLnZpZXdlZFByb2ZpbGUuSXNNdXRlZCA9IElzTXV0ZWQ7CiAgICAgIH0KICAgIH0sCiAgICBtc2dfc2V0QWNjb3VudEJsb2NrZWQ6IGZ1bmN0aW9uIG1zZ19zZXRBY2NvdW50QmxvY2tlZChfcmVmMjYsIF9yZWYyNykgewogICAgICB2YXIgc3RhdGUgPSBfcmVmMjYuc3RhdGU7CiAgICAgIHZhciBBY2NvdW50SWQgPSBfcmVmMjcuQWNjb3VudElkLAogICAgICAgICAgSXNCbG9ja2VkID0gX3JlZjI3LklzQmxvY2tlZDsKCiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLnZpZXdlZFByb2ZpbGUuSWQgPT09IEFjY291bnRJZCkgewogICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZS5Jc0Jsb2NrZWQgPSBJc0Jsb2NrZWQ7CiAgICAgIH0KICAgIH0sCiAgICBtc2dfcmVtb3ZlQ29udGFjdDogZnVuY3Rpb24gbXNnX3JlbW92ZUNvbnRhY3QoX3JlZjI4LCBfcmVmMjkpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYyOC5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYyOC5zdGF0ZTsKICAgICAgdmFyIENvbnRhY3RJZCA9IF9yZWYyOS5Db250YWN0SWQsCiAgICAgICAgICBBY2NvdW50RGlzcGxheWVkTmFtZSA9IF9yZWYyOS5BY2NvdW50RGlzcGxheWVkTmFtZTsKICAgICAgdmFyIGNvbnRhY3QgPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkNvbnRhY3RzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ29udGFjdElkOwogICAgICB9KTsKCiAgICAgIGlmIChjb250YWN0KSB7CiAgICAgICAgdmFyIHByaXZhdGVDaGF0ID0gc3RhdGUubWVzc2VuZ2VyRGF0YS5DaGF0cy5maW5kKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICByZXR1cm4gYy5BY2NvdW50SWQgPT0gY29udGFjdC5BY2NvdW50SWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChwcml2YXRlQ2hhdCkgewogICAgICAgICAgY29tbWl0KCdtc2dfcmVuYW1lQ2hhdCcsIHsKICAgICAgICAgICAgQ2hhdElkOiBwcml2YXRlQ2hhdC5JZCwKICAgICAgICAgICAgTmFtZTogQWNjb3VudERpc3BsYXllZE5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZS5JZCA9PT0gY29udGFjdC5BY2NvdW50SWQpIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEudmlld2VkUHJvZmlsZS5EaXNwbGF5ZWROYW1lID0gQWNjb3VudERpc3BsYXllZE5hbWU7CiAgICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLnZpZXdlZFByb2ZpbGUuSXNJbkNvbnRhY3RzID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb21taXQoJ21zZ19yZW1vdmVTdG9yZUNvbnRhY3QnLCBDb250YWN0SWQpOwogICAgfSwKICAgIG1zZ19hZGRDb250YWN0OiBmdW5jdGlvbiBtc2dfYWRkQ29udGFjdChfcmVmMzAsIGNvbnRhY3QpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzMC5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYzMC5zdGF0ZTsKCiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLnZpZXdlZFByb2ZpbGUuSWQgPT09IGNvbnRhY3QuQWNjb3VudElkKSB7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS52aWV3ZWRQcm9maWxlLkRpc3BsYXllZE5hbWUgPSBjb250YWN0Lk5hbWU7CiAgICAgICAgc3RhdGUubWVzc2VuZ2VyRGF0YS52aWV3ZWRQcm9maWxlLklzSW5Db250YWN0cyA9IHRydWU7CiAgICAgIH0KCiAgICAgIGNvbW1pdCgnbXNnX2xvYWRDb250YWN0cycsIFtjb250YWN0XSk7CiAgICB9LAogICAgbXNnX2xvYWRDaGF0OiBmdW5jdGlvbiBtc2dfbG9hZENoYXQoX3JlZjMxLCBjaGF0KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMzEuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMzEuc3RhdGU7CgogICAgICBpZiAoIWNoYXQuU3Vic2NyaWJlcnNDb3VudCkgewogICAgICAgIGNoYXQuU3Vic2NyaWJlcnNDb3VudCA9IDA7CiAgICAgIH0KCiAgICAgIGNvbW1pdCgnbXNnX2xvYWRDaGF0cycsIFtjaGF0XSk7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gLTEgfHwgc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gY2hhdC5JZCkgewogICAgICAgIHdpbmRvdy5tcC50cmlnZ2VyU2VydmVyKCdwaG9uZTo6bXNnOjpyZXF1ZXN0Q2hhdCcsIGNoYXQuSWQpOwogICAgICB9CiAgICB9LAogICAgbXNnX2NyZWF0ZUNoYXQ6IGZ1bmN0aW9uIG1zZ19jcmVhdGVDaGF0KF9yZWYzMiwgX3JlZjMzKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmMzIuY29tbWl0OwogICAgICB2YXIgQ2hhdFR5cGUgPSBfcmVmMzMuQ2hhdFR5cGUsCiAgICAgICAgICBOYW1lID0gX3JlZjMzLk5hbWUsCiAgICAgICAgICBEZXNjcmlwdGlvbiA9IF9yZWYzMy5EZXNjcmlwdGlvbiwKICAgICAgICAgIEljb25Db2xvcnMgPSBfcmVmMzMuSWNvbkNvbG9ycywKICAgICAgICAgIFVzZXJzVG9JbnZpdGUgPSBfcmVmMzMuVXNlcnNUb0ludml0ZTsKICAgICAgY29tbWl0KCdtc2dfc2V0Q3VycmVudENoYXQnLCB7CiAgICAgICAgSWQ6IC0xLAogICAgICAgIE5hbWU6IE5hbWUsCiAgICAgICAgSXNPbmxpbmU6IGZhbHNlLAogICAgICAgIFR5cGU6IENoYXRUeXBlLAogICAgICAgIEljb25Db2xvcnM6IEljb25Db2xvcnMsCiAgICAgICAgU3Vic2NyaWJlcnNDb3VudDogMAogICAgICB9KTsKICAgICAgdmFyIHN1YnNlY3Rpb25zQnlDaGF0VHlwZSA9IHsKICAgICAgICAwOiAnUHJpdmF0ZVN1YnNlY3Rpb24nLAogICAgICAgIDE6ICdHcm91cFN1YnNlY3Rpb24nLAogICAgICAgIDI6ICdDYW5hbFN1YnNlY3Rpb24nCiAgICAgIH07CiAgICAgIGNvbW1pdCgnc21hcnRwaG9uZS9zZXRDdXJyZW50VGFiJywgewogICAgICAgIGtleTogJ01lc3NlbmdlclRhYicsCiAgICAgICAgc2VjdGlvbjogJ0NoYXRTZWN0aW9uJywKICAgICAgICBzdWJzZWN0aW9uOiBzdWJzZWN0aW9uc0J5Q2hhdFR5cGVbQ2hhdFR5cGVdLAogICAgICAgIGRhdGE6IG51bGwKICAgICAgfSwgewogICAgICAgIHJvb3Q6IHRydWUKICAgICAgfSk7CiAgICAgIGNvbW1pdCgnbXNnX3NldEN1cnJlbnRDaGF0SXNMb2FkaW5nJywgdHJ1ZSk7CgogICAgICBpZiAoQ2hhdFR5cGUgPT09IDEpIHsKICAgICAgICB3aW5kb3cubXAudHJpZ2dlclNlcnZlcigncGhvbmU6Om1zZzo6Y3JlYXRlR3JvdXBDaGF0JywgTmFtZSwgRGVzY3JpcHRpb24sIEljb25Db2xvcnMsIEpTT04uc3RyaW5naWZ5KFVzZXJzVG9JbnZpdGUpKTsKICAgICAgfSBlbHNlIGlmIChDaGF0VHlwZSA9PT0gMikgewogICAgICAgIHdpbmRvdy5tcC50cmlnZ2VyU2VydmVyKCdwaG9uZTo6bXNnOjpjcmVhdGVDaGFubmVsJywgTmFtZSwgRGVzY3JpcHRpb24sIEljb25Db2xvcnMpOwogICAgICB9CiAgICB9LAogICAgbXNnX3NlbmRNZXNzYWdlOiBmdW5jdGlvbiBtc2dfc2VuZE1lc3NhZ2UoX3JlZjM0LCBfcmVmMzUpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzNC5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYzNC5zdGF0ZSwKICAgICAgICAgIGRpc3BhdGNoID0gX3JlZjM0LmRpc3BhdGNoOwogICAgICB2YXIgQ2hhdElkID0gX3JlZjM1LkNoYXRJZCwKICAgICAgICAgIE1lc3NhZ2UgPSBfcmVmMzUuTWVzc2FnZTsKICAgICAgTWVzc2FnZS5DaGF0SWQgPSBDaGF0SWQ7CiAgICAgIE1lc3NhZ2UuVGltZSAqPSAxMDAwOwogICAgICBjb21taXQoJ21zZ19jYWNoZU1lc3NhZ2UnLCBNZXNzYWdlKTsKICAgICAgY29tbWl0KCdtc2dfc2V0TGFzdE1lc3NhZ2UnLCBNZXNzYWdlKTsKCiAgICAgIGlmICghc3RhdGUubWVzc2VuZ2VyRGF0YS5fY2FjaGVkQWNjb3VudHMuZmluZChmdW5jdGlvbiAoYSkgewogICAgICAgIHJldHVybiBhLklkID09PSBNZXNzYWdlLlNlbmRlcklkOwogICAgICB9KSkgewogICAgICAgIHdpbmRvdy5tcC50cmlnZ2VyU2VydmVyKCdwaG9uZTo6bXNnOjpyZXF1ZXN0QWNjb3VudHNOYW1lcycsICJbIi5jb25jYXQoTWVzc2FnZS5TZW5kZXJJZCwgIl0iKSk7CiAgICAgIH0KCiAgICAgIGlmIChzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0LklkID09PSBDaGF0SWQpIHsKICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0Lkl0ZW1zLnB1c2goTWVzc2FnZSk7CgogICAgICAgIGlmIChNZXNzYWdlLlNlbmRlcklkICE9PSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRBY2NvdW50LklkKSB7CiAgICAgICAgICB3aW5kb3cubXAudHJpZ2dlclNlcnZlcigncGhvbmU6Om1zZzo6bWFya0FzUmVhZCcsIENoYXRJZCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKE1lc3NhZ2UuU2VuZGVySWQgIT09IHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudEFjY291bnQuSWQpIHsKICAgICAgICB2YXIgY2hhdCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgICAgcmV0dXJuIGMuSWQgPT09IENoYXRJZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGNoYXQpIHsKICAgICAgICAgIGNoYXQuTm9uUmVhZE1lc3NhZ2VzQ291bnQrKzsKCiAgICAgICAgICBpZiAoIWNoYXQuSXNNdXRlZCkgewogICAgICAgICAgICBkaXNwYXRjaCgnc21hcnRwaG9uZS9zb3VuZHNfcGxheU5vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG1zZ19kZWxldGVNZXNzYWdlOiBmdW5jdGlvbiBtc2dfZGVsZXRlTWVzc2FnZShfcmVmMzYsIE1lc3NhZ2VJZCkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjM2LmNvbW1pdCwKICAgICAgICAgIHN0YXRlID0gX3JlZjM2LnN0YXRlOwogICAgICBjb21taXQoJ21zZ191bmNhY2hlTWVzc2FnZScsIE1lc3NhZ2VJZCk7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JdGVtcykgewogICAgICAgIHZhciBtc2dJZHggPSBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0Lkl0ZW1zLmZpbmRJbmRleChmdW5jdGlvbiAobSkgewogICAgICAgICAgcmV0dXJuIG0uSWQgPT09IE1lc3NhZ2VJZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKG1zZ0lkeCAhPT0gLTEpIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSXRlbXMuc3BsaWNlKG1zZ0lkeCwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbXNnX2VkaXRNZXNzYWdlOiBmdW5jdGlvbiBtc2dfZWRpdE1lc3NhZ2UoX3JlZjM3LCBfcmVmMzgpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzNy5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWYzNy5zdGF0ZTsKICAgICAgdmFyIENoYXRJZCA9IF9yZWYzOC5DaGF0SWQsCiAgICAgICAgICBNZXNzYWdlID0gX3JlZjM4Lk1lc3NhZ2U7CiAgICAgIE1lc3NhZ2UuQ2hhdElkID0gQ2hhdElkOwogICAgICBNZXNzYWdlLlRpbWUgKj0gMTAwMDsKICAgICAgY29tbWl0KCdtc2dfY2FjaGVNZXNzYWdlJywgTWVzc2FnZSk7CgogICAgICBpZiAoc3RhdGUubWVzc2VuZ2VyRGF0YS5DdXJyZW50Q2hhdC5JZCA9PT0gQ2hhdElkKSB7CiAgICAgICAgdmFyIG1zZ0lkeCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICByZXR1cm4gbS5JZCA9PT0gTWVzc2FnZS5JZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKG1zZ0lkeCAhPT0gLTEpIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSXRlbXMuc3BsaWNlKG1zZ0lkeCwgMSk7CiAgICAgICAgICBzdGF0ZS5tZXNzZW5nZXJEYXRhLkN1cnJlbnRDaGF0Lkl0ZW1zLnB1c2goTWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbXNnX2RlbGV0ZUNoYXQ6IGZ1bmN0aW9uIG1zZ19kZWxldGVDaGF0KF9yZWYzOSwgY2hhdElkKSB7CiAgICAgIHZhciBzdGF0ZSA9IF9yZWYzOS5zdGF0ZSwKICAgICAgICAgIGNvbW1pdCA9IF9yZWYzOS5jb21taXQ7CiAgICAgIGNvbW1pdCgnbXNnX3JlbW92ZUNoYXQnLCBjaGF0SWQpOwoKICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSWQgPT09IGNoYXRJZCkgewogICAgICAgIGNvbW1pdCgnc21hcnRwaG9uZS9zZXRDdXJyZW50VGFiJywgewogICAgICAgICAga2V5OiAnTWVzc2VuZ2VyVGFiJywKICAgICAgICAgIHNlY3Rpb246ICdHZW5lcmFsU2VjdGlvbicsCiAgICAgICAgICBzdWJzZWN0aW9uOiAnR2VuZXJhbFN1YnNlY3Rpb24nLAogICAgICAgICAgZGF0YTogbnVsbAogICAgICAgIH0sIHsKICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG1zZ19zZXRJbkNoYXRCbG9ja2VkOiBmdW5jdGlvbiBtc2dfc2V0SW5DaGF0QmxvY2tlZChfcmVmNDAsIF9yZWY0MSkgewogICAgICB2YXIgc3RhdGUgPSBfcmVmNDAuc3RhdGUsCiAgICAgICAgICBkaXNwYXRjaCA9IF9yZWY0MC5kaXNwYXRjaDsKICAgICAgdmFyIENoYXRJZCA9IF9yZWY0MS5DaGF0SWQsCiAgICAgICAgICBJc0Jsb2NrZWQgPSBfcmVmNDEuSXNCbG9ja2VkOwoKICAgICAgaWYgKHN0YXRlLm1lc3NlbmdlckRhdGEuQ3VycmVudENoYXQuSWQgPT09IENoYXRJZCkgewogICAgICAgIGRpc3BhdGNoKCdzbWFydHBob25lL21zZ19nb1RvQ2hhdHMnLCB0cnVlLCB7CiAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChJc0Jsb2NrZWQpIHsKICAgICAgICB2YXIgY2hhdElkeCA9IHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuZmluZEluZGV4KGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICByZXR1cm4gYy5JZCA9PT0gQ2hhdElkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoY2hhdElkeCAhPT0gLTEpIHsKICAgICAgICAgIHN0YXRlLm1lc3NlbmdlckRhdGEuQ2hhdHMuc3BsaWNlKGNoYXRJZHgsIDEpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTs="},null]}