<template>
  <div class="wshop">
    <div class="wshop-header" :style="{'opacity': mouseOverHead ? 1 : .1}" @mouseenter="mouseOverHead = true" @mouseleave="mouseOverHead = false">
      <div class="wshop-tittle">
        <div class="wshop-tittle-text">{{ loc("wshop_tittle") }}</div>
        <div class="wshop-tittle-esc" @click="exit">
          {{ loc("wshop_esc_close") }}
        </div>
      </div>
      <div class="wshop-items">   
            <WeaponItem
              id="wshopItem"
              v-for="(weapon, index) in weapons"
              :key="index"
              :index="index"
              :weapon="weapon"
              :isCurrent="current == index"
              @onSelect="onWeaponSelect(index)"
            />      
      </div>
    </div>    
    <div
      class="wshop-components"
      v-if="weapons[current] !== undefined && weapons[current].isWeapon()"
    >
      <div class="wshop-components-tittle">
        {{ loc("wshop_comp_tittle") }}
      </div>
      <div
        v-for="(component, key) in wcomponents"
        :key="key"
        class="wshop-components-wrapper"
      >
        <ComponentsList
          v-if="Object.keys(component).length > 0"
          :cSlot="key"
          :components="component"
          @onSelect="onComponentSelect"
        />
      </div>
    </div>
    <div class="wshop-name" v-if="weapons[current] !== undefined">
      {{ loc(weapons[current].getName()) }}
    </div>

    <div class="wshop-right">
      <AmmoCount
        v-if="weapons[current] !== undefined && weapons[current].isAmmo()"
        @onChage="onAmmoChange"
      />
      <div class="wshop-cost">
        <div
          class="wshop-cost-item"
          v-for="(item, key, index) in prices"
          :key="index"
        >
          <div class="wshop-cost-item-tittle">{{ loc(key) }}:</div>
          <div class="wshop-cost-item-value">$ {{ item }}</div>
        </div>
        <div class="wshop-cost-total">
          <div class="wshop-cost-total-tittle">
            {{ loc("wshop_comp_cost") }}
          </div>
          <div class="wshop-cost-total-value">$ {{ totalPrice() }}</div>
        </div>
        <div class="wshop-cost-meth">
          <svg
            width="45"
            height="32"
            viewBox="0 0 45 32"
            :fill="
              payCard ? 'rgba(255,255,255, .65)' : 'rgba(255,255,255, .15)'
            "
            xmlns="http://www.w3.org/2000/svg"
            @click="payCard = true"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M3.32881 0.0610687C3.32881 0.0946565 3.22895 0.122137 3.10689 0.122137C2.98483 0.122137 2.88497 0.149618 2.88497 0.183206C2.88497 0.216794 2.81007 0.244275 2.71853 0.244275C2.62699 0.244275 2.55209 0.271756 2.55209 0.305344C2.55209 0.338931 2.50216 0.366412 2.44113 0.366412C2.3801 0.366412 2.33017 0.393893 2.33017 0.427481C2.33017 0.461069 2.28024 0.48855 2.21921 0.48855C2.15818 0.48855 2.10825 0.516031 2.10825 0.549618C2.10825 0.583206 2.05831 0.610687 1.99729 0.610687C1.93626 0.610687 1.88633 0.638168 1.88633 0.671756C1.88633 0.705344 1.84854 0.732825 1.80238 0.732825C1.69292 0.732825 0.665762 1.86345 0.665762 1.98394C0.665762 2.03475 0.640796 2.07634 0.610282 2.07634C0.579768 2.07634 0.554802 2.1313 0.554802 2.19847C0.554802 2.26565 0.529836 2.32061 0.499322 2.32061C0.468807 2.32061 0.443841 2.37557 0.443841 2.44275C0.443841 2.50992 0.418875 2.56489 0.388361 2.56489C0.357847 2.56489 0.332881 2.61985 0.332881 2.68702C0.332881 2.7542 0.307915 2.80916 0.277401 2.80916C0.246887 2.80916 0.221921 2.8916 0.221921 2.99237C0.221921 3.09313 0.196955 3.17557 0.166441 3.17557C0.135926 3.17557 0.11096 3.2855 0.11096 3.41985C0.11096 3.5542 0.0859943 3.66412 0.0554802 3.66412C0.0186968 3.66412 0 7.81679 0 16C0 24.1832 0.0186968 28.3359 0.0554802 28.3359C0.0859943 28.3359 0.11096 28.4458 0.11096 28.5802C0.11096 28.7145 0.135926 28.8244 0.166441 28.8244C0.196955 28.8244 0.221921 28.9069 0.221921 29.0076C0.221921 29.1084 0.246887 29.1908 0.277401 29.1908C0.307915 29.1908 0.332881 29.2458 0.332881 29.313C0.332881 29.3802 0.357847 29.4351 0.388361 29.4351C0.418875 29.4351 0.443841 29.4901 0.443841 29.5573C0.443841 29.6244 0.468807 29.6794 0.499322 29.6794C0.529836 29.6794 0.554802 29.7283 0.554802 29.788C0.554802 29.8478 0.604734 29.9363 0.665762 29.9847C0.72679 30.0332 0.776722 30.1083 0.776722 30.1519C0.776722 30.255 1.58529 31.145 1.679 31.145C1.71855 31.145 1.78685 31.2 1.83085 31.2672C1.87484 31.3344 1.95523 31.3893 2.00955 31.3893C2.06381 31.3893 2.10825 31.4168 2.10825 31.4504C2.10825 31.484 2.15818 31.5115 2.21921 31.5115C2.28024 31.5115 2.33017 31.5389 2.33017 31.5725C2.33017 31.6061 2.3801 31.6336 2.44113 31.6336C2.50216 31.6336 2.55209 31.6611 2.55209 31.6947C2.55209 31.7282 2.62699 31.7557 2.71853 31.7557C2.81007 31.7557 2.88497 31.7832 2.88497 31.8168C2.88497 31.8504 2.98483 31.8779 3.10689 31.8779C3.22895 31.8779 3.32881 31.9053 3.32881 31.9389C3.32881 31.9795 9.69056 32 22.303 32C34.9155 32 41.2772 31.9795 41.2772 31.9389C41.2772 31.9053 41.3771 31.8779 41.4992 31.8779C41.6212 31.8779 41.7211 31.8504 41.7211 31.8168C41.7211 31.7832 41.796 31.7557 41.8875 31.7557C41.9791 31.7557 42.054 31.7282 42.054 31.6947C42.054 31.6611 42.1039 31.6336 42.1649 31.6336C42.226 31.6336 42.2759 31.6061 42.2759 31.5725C42.2759 31.5389 42.3258 31.5115 42.3868 31.5115C42.4479 31.5115 42.4978 31.484 42.4978 31.4504C42.4978 31.4168 42.5423 31.3893 42.5965 31.3893C42.6508 31.3893 42.7312 31.3344 42.7752 31.2672C42.8192 31.2 42.8875 31.145 42.9271 31.145C43.0208 31.145 43.8293 30.255 43.8293 30.1519C43.8293 30.1083 43.8793 30.0332 43.9403 29.9847C44.0013 29.9363 44.0513 29.8478 44.0513 29.788C44.0513 29.7283 44.0762 29.6794 44.1067 29.6794C44.1372 29.6794 44.1622 29.6244 44.1622 29.5573C44.1622 29.4901 44.1872 29.4351 44.2177 29.4351C44.2482 29.4351 44.2732 29.3802 44.2732 29.313C44.2732 29.2458 44.2981 29.1908 44.3287 29.1908C44.3592 29.1908 44.3841 29.1084 44.3841 29.0076C44.3841 28.9069 44.4091 28.8244 44.4396 28.8244C44.4701 28.8244 44.4951 28.7145 44.4951 28.5802C44.4951 28.4458 44.5201 28.3359 44.5506 28.3359C44.5874 28.3359 44.6061 24.1832 44.6061 16C44.6061 7.81679 44.5874 3.66412 44.5506 3.66412C44.5201 3.66412 44.4951 3.5542 44.4951 3.41985C44.4951 3.2855 44.4701 3.17557 44.4396 3.17557C44.4091 3.17557 44.3841 3.09313 44.3841 2.99237C44.3841 2.8916 44.3592 2.80916 44.3287 2.80916C44.2981 2.80916 44.2732 2.7542 44.2732 2.68702C44.2732 2.61985 44.2482 2.56489 44.2177 2.56489C44.1872 2.56489 44.1622 2.50992 44.1622 2.44275C44.1622 2.37557 44.1372 2.32061 44.1067 2.32061C44.0762 2.32061 44.0513 2.26565 44.0513 2.19847C44.0513 2.1313 44.0263 2.07634 43.9958 2.07634C43.9653 2.07634 43.9403 2.03475 43.9403 1.98394C43.9403 1.86345 42.9131 0.732825 42.8037 0.732825C42.7575 0.732825 42.7197 0.705344 42.7197 0.671756C42.7197 0.638168 42.6698 0.610687 42.6088 0.610687C42.5477 0.610687 42.4978 0.583206 42.4978 0.549618C42.4978 0.516031 42.4479 0.48855 42.3868 0.48855C42.3258 0.48855 42.2759 0.461069 42.2759 0.427481C42.2759 0.393893 42.226 0.366412 42.1649 0.366412C42.1039 0.366412 42.054 0.338931 42.054 0.305344C42.054 0.271756 41.9791 0.244275 41.8875 0.244275C41.796 0.244275 41.7211 0.216794 41.7211 0.183206C41.7211 0.149618 41.6212 0.122137 41.4992 0.122137C41.3771 0.122137 41.2772 0.0946565 41.2772 0.0610687C41.2772 0.020458 34.9155 0 22.303 0C9.69056 0 3.32881 0.020458 3.32881 0.0610687ZM40.8334 2.99237C40.8334 3.02595 40.9083 3.05344 40.9998 3.05344C41.0914 3.05344 41.1663 3.08092 41.1663 3.1145C41.1663 3.14809 41.2046 3.17557 41.2513 3.17557C41.3618 3.17557 41.7211 3.57105 41.7211 3.69264C41.7211 3.74412 41.7461 3.78626 41.7766 3.78626C41.8071 3.78626 41.8321 3.8687 41.8321 3.96947C41.8321 4.07023 41.857 4.15267 41.8875 4.15267C41.9231 4.15267 41.943 4.74302 41.943 5.80153V7.45038H22.303H2.66305V5.80153C2.66305 4.74302 2.68291 4.15267 2.71853 4.15267C2.74904 4.15267 2.77401 4.07023 2.77401 3.96947C2.77401 3.8687 2.79897 3.78626 2.82949 3.78626C2.86 3.78626 2.88497 3.74412 2.88497 3.69264C2.88497 3.57105 3.24426 3.17557 3.35472 3.17557C3.40149 3.17557 3.43977 3.14809 3.43977 3.1145C3.43977 3.08092 3.51467 3.05344 3.60621 3.05344C3.69775 3.05344 3.77265 3.02595 3.77265 2.99237C3.77265 2.95176 9.98643 2.9313 22.303 2.9313C34.6196 2.9313 40.8334 2.95176 40.8334 2.99237ZM41.943 20.6412C41.943 25.4046 41.9242 27.8473 41.8875 27.8473C41.857 27.8473 41.8321 27.9237 41.8321 28.017C41.8321 28.1167 41.7862 28.2231 41.7211 28.2748C41.6601 28.3232 41.6101 28.3999 41.6101 28.4453C41.6101 28.5516 41.4733 28.7023 41.3767 28.7023C41.3354 28.7023 41.2658 28.7573 41.2218 28.8244C41.1661 28.9095 41.0781 28.9466 40.9321 28.9466C40.8168 28.9466 40.7224 28.974 40.7224 29.0076C40.7224 29.0482 34.5457 29.0687 22.303 29.0687C10.0604 29.0687 3.88361 29.0482 3.88361 29.0076C3.88361 28.974 3.78924 28.9466 3.67395 28.9466C3.52793 28.9466 3.43999 28.9095 3.38429 28.8244C3.34029 28.7573 3.27122 28.7023 3.23083 28.7023C3.12958 28.7023 2.88497 28.4235 2.88497 28.3081C2.88497 28.2562 2.86 28.2137 2.82949 28.2137C2.79897 28.2137 2.77401 28.1313 2.77401 28.0305C2.77401 27.9298 2.74904 27.8473 2.71853 27.8473C2.68186 27.8473 2.66305 25.4046 2.66305 20.6412V13.4351H22.303H41.943V20.6412ZM8.32203 21.6794C8.32203 21.713 8.27209 21.7405 8.21107 21.7405C8.15004 21.7405 8.10011 21.7679 8.10011 21.8015C8.10011 21.8351 8.06155 21.8626 8.01439 21.8626C7.90337 21.8626 7.65626 22.1346 7.65626 22.2568C7.65626 22.3087 7.6313 22.3511 7.60078 22.3511C7.57027 22.3511 7.5453 22.4061 7.5453 22.4733C7.5453 22.5405 7.52034 22.5954 7.48982 22.5954C7.45748 22.5954 7.43434 22.799 7.43434 23.084C7.43434 23.369 7.45748 23.5725 7.48982 23.5725C7.52034 23.5725 7.5453 23.6143 7.5453 23.6655C7.5453 23.8253 8.13617 24.4275 8.29307 24.4275C8.37002 24.4275 8.43299 24.455 8.43299 24.4886C8.43299 24.5289 10.5042 24.5496 14.5358 24.5496C18.5674 24.5496 20.6386 24.5289 20.6386 24.4886C20.6386 24.455 20.7017 24.4275 20.7788 24.4275C20.9355 24.4275 21.4153 23.9453 21.4153 23.7878C21.4153 23.7366 21.4403 23.6947 21.4708 23.6947C21.5013 23.6947 21.5263 23.6397 21.5263 23.5725C21.5263 23.5053 21.5513 23.4504 21.5818 23.4504C21.6126 23.4504 21.6373 23.2875 21.6373 23.084C21.6373 22.8804 21.6126 22.7176 21.5818 22.7176C21.5513 22.7176 21.5263 22.6412 21.5263 22.5478C21.5263 22.4482 21.4805 22.3418 21.4153 22.2901C21.3543 22.2416 21.3044 22.1649 21.3044 22.1196C21.3044 22.0078 21.1656 21.8626 21.0587 21.8626C21.0107 21.8626 20.9715 21.8351 20.9715 21.8015C20.9715 21.7679 20.9216 21.7405 20.8605 21.7405C20.7995 21.7405 20.7496 21.713 20.7496 21.6794C20.7496 21.639 18.6413 21.6183 14.5358 21.6183C10.4303 21.6183 8.32203 21.639 8.32203 21.6794Z"
            />
          </svg>
          <svg
            width="35"
            height="32"
            viewBox="0 0 35 32"
            :fill="
              payCard ? 'rgba(255,255,255, .15)' : 'rgba(255,255,255, .65)'
            "
            xmlns="http://www.w3.org/2000/svg"
            @click="payCard = false"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M18.285 0.0536406C18.2061 0.0840008 16.2365 1.10534 13.9082 2.32329L9.67483 4.53769L6.3886 4.55634C4.512 4.56698 3.01618 4.58754 2.90146 4.60429C2.6057 4.64745 2.06937 4.81453 1.83954 4.93511C1.38994 5.17097 0.9563 5.54965 0.638612 5.98384C0.491291 6.18518 0.230833 6.72639 0.132591 7.03521C0.0994125 7.13959 0.0565903 7.33515 0.0374757 7.46978C-0.0109137 7.81028 -0.0132093 28.7187 0.0350652 29.0986C0.069133 29.3666 0.204573 29.82 0.326063 30.0727C0.505471 30.4459 0.866009 30.9241 1.14868 31.1638C1.36755 31.3494 1.64388 31.5498 1.78213 31.6233C1.95465 31.7149 2.59092 31.9246 2.78666 31.9544C2.92032 31.9747 7.81852 31.9885 17.4234 31.9955C30.6733 32.0052 31.871 32.0021 32.0033 31.9575C32.3249 31.8491 32.6232 31.5683 32.7415 31.2626L32.8076 31.0917L32.8219 28.1893L32.8363 25.287L32.904 25.2297C32.9636 25.1794 33.0209 25.1725 33.3776 25.1724C34.1628 25.1724 34.5847 25.0087 34.8242 24.6113C35.0152 24.2942 35.0047 24.5444 34.9964 20.5407L34.9888 16.9156L34.9197 16.7357C34.8239 16.4864 34.5377 16.1879 34.3 16.0894C34.1439 16.0247 34.0719 16.0166 33.5297 16.0023C32.9443 15.9868 32.9303 15.985 32.8767 15.9157C32.8237 15.8472 32.8219 15.7551 32.8219 13.0042C32.8219 10.2644 32.8199 10.1567 32.7655 9.97272C32.6756 9.66863 32.3641 9.32658 32.0828 9.22297C31.9736 9.18275 31.8311 9.17235 31.3641 9.17049C30.7853 9.16816 30.7811 9.16771 30.7111 9.09458L30.6407 9.02103V7.3127V5.60438L30.5714 5.40516C30.4728 5.12134 30.338 4.92821 30.1427 4.79107C29.8163 4.56176 29.9049 4.57066 27.7808 4.55325C25.9336 4.53811 25.8806 4.53608 25.8187 4.47775C25.7838 4.44479 25.3379 3.54791 24.8278 2.48471C24.0196 0.799849 23.8828 0.532811 23.762 0.405346C23.5819 0.215362 23.4608 0.132733 23.2529 0.0580462C23.042 -0.0177196 22.8599 -0.0192481 22.6592 0.053071C22.5739 0.0838209 21.9714 0.387273 21.3203 0.72741C20.5781 1.11511 20.1047 1.34582 20.0514 1.34582C19.934 1.34582 19.8707 1.26538 19.6976 0.896264C19.5084 0.49292 19.242 0.194952 18.9739 0.086908C18.7445 -0.00552138 18.4729 -0.0186185 18.285 0.0536406ZM18.1357 2.82658C18.1957 2.89506 21.0564 8.84061 21.0961 8.97931C21.1092 9.02484 21.0968 9.06419 21.0561 9.10669L20.9973 9.16816H13.5406C5.46885 9.16816 5.89305 9.17667 6.03021 9.01749C6.10113 8.93519 17.9157 2.7584 18.0066 2.75609C18.0429 2.75519 18.101 2.7869 18.1357 2.82658ZM22.5417 2.83686C22.5725 2.88218 23.245 4.27132 24.0361 5.92378C24.9652 7.86425 25.4746 8.95977 25.4746 9.01719C25.4746 9.07444 25.4548 9.11715 25.4191 9.13714C25.3484 9.17661 23.8127 9.17918 23.714 9.13998C23.6205 9.10288 23.5428 8.95411 22.8051 7.39989C22.5508 6.86416 22.3055 6.35167 22.2599 6.261C22.2144 6.17034 21.918 5.54995 21.6014 4.88236C21.0418 3.70256 20.9858 3.55634 21.0518 3.44751C21.0904 3.38395 22.3218 2.75543 22.4088 2.75489C22.4604 2.75459 22.5042 2.78163 22.5417 2.83686ZM4.77418 6.90927C4.80969 6.91922 4.83876 6.94365 4.83876 6.96358C4.83876 6.98351 4.80969 7.02777 4.77418 7.06197C4.66882 7.16336 2.46639 8.29901 2.37509 8.29901C2.05043 8.29901 2.14523 7.5798 2.52172 7.18665C2.61615 7.08804 2.78445 6.99016 2.95886 6.93241C3.07886 6.89267 4.64359 6.87274 4.77418 6.90927ZM28.389 6.96397L28.4594 7.03751V7.99651C28.4594 9.01126 28.452 9.07483 28.3258 9.13489C28.2269 9.18191 28.1714 9.1764 28.0658 9.1092C27.9884 9.0599 27.8972 8.89093 27.499 8.05957C27.238 7.51459 27.0244 7.04977 27.0244 7.02663C27.0244 7.0035 27.0447 6.9634 27.0695 6.93747C27.1076 6.89767 27.2076 6.89039 27.7166 6.89039C28.3174 6.89039 28.3187 6.89054 28.389 6.96397ZM2.514 11.3153C2.58504 11.3419 2.73356 11.3775 2.84406 11.3943C2.97752 11.4147 7.65874 11.431 16.7879 11.443L30.531 11.4609L30.5858 11.5317C30.6387 11.5999 30.6407 11.6798 30.6407 13.7284V15.8543L30.5702 15.9279L30.4998 16.0015H28.1986C25.964 16.0015 25.8066 16.0067 25.3598 16.0967C25.1161 16.1458 24.624 16.3254 24.3696 16.4581C23.8475 16.7304 23.5697 16.9389 23.1628 17.3637C22.5518 18.0018 22.23 18.5911 22.0328 19.4331C21.8129 20.3719 21.8041 20.7216 21.9801 21.531C22.0612 21.904 22.223 22.4088 22.3028 22.5375C22.3394 22.5965 22.4145 22.7386 22.4697 22.8532C22.6993 23.3292 23.1698 23.8777 23.6686 24.2509C24.3441 24.7563 25.1007 25.0483 25.9194 25.1196C26.0931 25.1347 27.2017 25.1561 28.3831 25.1672L30.531 25.1875L30.5858 25.2582C30.6387 25.3264 30.6407 25.4066 30.6407 27.4549V29.5809L30.5702 29.6544L30.4998 29.728H16.8573C1.74083 29.728 3.05068 29.7462 2.71244 29.5316C2.50456 29.3998 2.38591 29.259 2.273 29.0101L2.18394 28.8139L2.17657 20.11C2.17 12.3397 2.17393 11.3985 2.2131 11.3361C2.26471 11.2538 2.33655 11.2489 2.514 11.3153ZM32.7515 18.3528L32.8219 18.4263V20.557V22.6876L32.7509 22.7618L32.6799 22.8359L29.2423 22.8279L25.8046 22.8198L25.575 22.7381C24.8557 22.4823 24.334 21.8818 24.1228 21.0665C24.1035 20.9923 24.088 20.7698 24.0883 20.572C24.0887 20.262 24.1005 20.1702 24.1743 19.9071C24.287 19.5048 24.3999 19.3137 24.7283 18.9694C25.0155 18.6683 25.1892 18.5518 25.5319 18.4302C25.943 18.2844 25.8901 18.2864 29.3863 18.2827L32.681 18.2792L32.7515 18.3528Z"
            />
          </svg>
        </div>
      </div>
      <div class="wshop-button" @click="buyWeapon">
        {{ loc("wshop_buy") }}
      </div>
    </div>
  </div>
</template>

<script>
import { mapState, mapGetters, mapMutations } from "vuex";
import ComponentsList from "./ComponentsList";
import WeaponItem from "./WeaponItem";
import AmmoCount from "./AmmoCount";

export default {
  computed: {
    ...mapState("weaponShop", ["weapons", "loadingWeapon"]),
    ...mapGetters("localization", ["loc"]),
    wcomponents() {
      if (this.weapons[this.current] == undefined) return {};
      else return this.weapons[this.current].getComponents() || {};
    },
  },
  data() {
    return {
      current: -1,
      ammo: 1,
      prices: {},
      payCard: false,
      mouseOverHead: false
    };
  },
  methods: {
    ...mapMutations("weaponShop", ["loadWeapon"]),
    onComponentSelect(slot, compIndex, component) {
      if (this.loadingWeapon) return;
      const item = this.weapons[this.current];
      const price = (item.price * +component.price).toFixed();
      this.$set(this.prices, component.slot, +price);
      const isWeapon = item.isWeapon();
      this.loadWeapon({
        id: item.id,
        slot,
        compIndex,
        model: isWeapon ? -1 : item.getModel(),
      });
    },
    move(to) {
      if (to > 0) {
        if (this.weapons[this.current + 1] !== undefined)
          this.onWeaponSelect(this.current + 1);
      } else if (to < 0) {
        if (this.current > 0) this.onWeaponSelect(this.current - 1);
      }
    },
    onAmmoChange(val) {
      this.ammo = val;
      this.$set(
        this.prices,
        "weapon",
        this.weapons[this.current].isAmmo()
          ? this.weapons[this.current].price * this.ammo
          : this.weapons[this.current].price
      );
    },
    totalPrice() {
      let total = 0;
      for (const key in this.prices) {
        total += this.prices[key];
      }
      return total;
    },
    onWeaponSelect(index) {
      this.current = index;
      this.prices = {};
      const item = this.weapons[this.current];
      this.$set(
        this.prices,
        "weapon",
        item.isAmmo() ? item.price * this.ammo : item.price
      );
      const isWeapon = item.isWeapon();
      this.loadWeapon({
        id: item.id,
        slot: -1,
        compIndex: -1,
        model: isWeapon ? -1 : item.getModel(),
      });
    },
    buyWeapon() {
      if (this.current == -1 || this.loadingWeapon) return;
      const count = this.weapons[this.current].isAmmo() ? this.ammo : 1;
      window.mp.trigger("cef:wshop:buy", count, this.payCard);
    },
    exit() {
      window.mp.trigger("cef:wshop:close");
    },
  },
  mounted() {
    if (process.env.NODE_ENV == "development")
      this.$store.commit("weaponShop/setWeapons", [
        [52, 1800],
        [55, 2880],
        [93, 5760],
        [69, 5000],
        [66, 4320],
        [67, 4320],
        [68, 4320],
        [120, 4320],
        [67, 4320],
        [68, 4320],
        [120, 4320],
        [67, 4320],
        [68, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
        [120, 4320],
      ]);
  },
  components: {
    ComponentsList,
    WeaponItem,
    AmmoCount,
  },
};
</script>

<style lang="scss" scoped>
.wshop {
  text-transform: uppercase;
  font-style: normal;
  font-weight: 300;
  font-size: 1rem;
  line-height: 1rem;
  letter-spacing: 0.03rem;
  color: #fff;
  width: 100vw;
  height: 100vh;
  position: absolute;
  left: 0;
  top: 0;
  background: url(/img/weaponShop/bg.svg) no-repeat center;
  background-size: cover;
  &-header{
    position: absolute;
    background-color: rgba(0,0,0,.5);
    //border-radius: .5rem;
    //border: .2rem solid rgba(#fff, .5);
    padding: 1rem 1.5rem;
    width: 100%;
    transition: all 1s;
    z-index: 100;
  }
  &-tittle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-height: 3.5rem;
    &-text {
      font-size: 3.6rem;
      font-weight: normal;
    }
    &-esc {
      font-size: 1.5rem;
      font-weight: normal;
      &:hover {
        text-shadow: 0 0 0.4rem #fff;
      }
    }
  }
  &-items {
    width: 100%;
    display: flex;    
    flex-wrap: wrap;
    max-height: 9rem;
    overflow-y: auto;
    &::-webkit-scrollbar {
      width: 2px;
    }
    &::-webkit-scrollbar-track {
      border: solid 0 transparent;
      margin: .1rem;
    }
    &::-webkit-scrollbar-thumb {
      border: solid 0 transparent;      
      background-color: rgba(#c1e704,.3);
    }
  }
  &-cost {
    position: absolute;
    right: 0;
    bottom: 4rem;
    text-align: right;
    width: 100%;
    &-meth {
      margin: 1.5rem 0 0;
      svg {
        margin-left: 0.5rem;
      }
    }
    &-total {
      width: 100%;
      &-tittle {
        color: rgba(#fff, 0.65);
        margin: 1rem 0;
      }
      &-value {
        font-size: 2.4rem;
        color: #c1e704;
      }
    }
    &-item {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      line-height: 0.8rem;
      margin: 0.5rem 0;
      width: 50%;
      margin-left: auto;
      &-tittle {
        color: rgba(#fff, 0.65);
      }
      &-value {
        color: #c1e704;
      }
    }
  }
  &-right {
    position: absolute;
    right: 2rem;
    bottom: 1rem;
    width: 13rem;
    height: 37rem;
  }
  &-name {
    font-size: 3.6rem;
    line-height: 3.6rem;
    color: #c1e704;
    text-align: center;
    position: absolute;
    bottom: 0;
    width: 100%;
  }
  
  &-components {
    margin: 15rem 2rem;
    width: 15rem;
    height: 25rem;
    &-tittle {
      font-size: 2.4rem;
      line-height: 2.4rem;
    }
  }
  &-button {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 3.1rem;
    color: #000;
    font-size: 1rem;
    line-height: 1rem;
    font-weight: 600;
    background-color: #b6d300;
    box-shadow: 0px 10px 50px -12px #a8c302;
  }
  
}
</style>