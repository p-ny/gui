<template>
  <div class="arena-menu__main">
    <!-- <audio id="cardSound" src="sounds/arenaMenu/mainmenu.mp3" loop autoplay></audio> -->
    <transition appear name="main-games">
      <div class="main__games">
        <div class="games__nav">
          <div
            v-for="mode in modes"
            :key="mode.id"
            :class="[{ active: mode.title === currentModeTitle }, 'nav__item']"
            @click="setCurrentMode(mode.title)"
          >
            <svg v-if="mode.title === 'Team fight'" width="32" height="32" viewBox="0 0 32 32" class="nav__logo" xmlns="http://www.w3.org/2000/svg">
              <path d="M27.3806 17.0825H24.9058C25.1581 17.7731 25.2959 18.5185 25.2959 19.2953V28.6484C25.2959 28.9723 25.2395 29.2832 25.1369 29.5723H29.2283C30.7566 29.5723 31.9999 28.3289 31.9999 26.8007V21.7018C31.9999 19.1548 29.9277 17.0825 27.3806 17.0825Z"/>
              <path d="M6.70408 19.2954C6.70408 18.5185 6.84189 17.7733 7.09414 17.0826H4.61938C2.07225 17.0826 0 19.1549 0 21.702V26.8008C0 28.3291 1.24331 29.5725 2.77163 29.5725H6.86301C6.76045 29.2832 6.70408 28.9724 6.70408 28.6485V19.2954Z"/>
              <path d="M18.8288 14.676H13.1711C10.624 14.676 8.55176 16.7483 8.55176 19.2954V28.6485C8.55176 29.1587 8.96538 29.5724 9.47563 29.5724H22.5243C23.0345 29.5724 23.4482 29.1588 23.4482 28.6485V19.2954C23.4482 16.7483 21.3759 14.676 18.8288 14.676Z"/>
              <path d="M16.0002 2.42749C12.937 2.42749 10.4448 4.91962 10.4448 7.98294C10.4448 10.0608 11.5916 11.8755 13.2853 12.8282C14.0886 13.2801 15.0147 13.5383 16.0002 13.5383C16.9857 13.5383 17.9118 13.2801 18.7151 12.8282C20.4088 11.8755 21.5556 10.0607 21.5556 7.98294C21.5556 4.91968 19.0635 2.42749 16.0002 2.42749Z"/>
              <path d="M6.24497 7.60559C3.95402 7.60559 2.09027 9.46935 2.09027 11.7603C2.09027 14.0512 3.95402 15.915 6.24497 15.915C6.82609 15.915 7.37947 15.7946 7.88216 15.5782C8.75128 15.204 9.46791 14.5417 9.91135 13.712C10.2226 13.1297 10.3997 12.4654 10.3997 11.7603C10.3997 9.46941 8.53591 7.60559 6.24497 7.60559Z"/>
              <path d="M25.7552 7.60559C23.4643 7.60559 21.6005 9.46935 21.6005 11.7603C21.6005 12.4654 21.7776 13.1297 22.0888 13.712C22.5323 14.5417 23.2489 15.2041 24.118 15.5782C24.6207 15.7946 25.1741 15.915 25.7552 15.915C28.0462 15.915 29.9099 14.0512 29.9099 11.7603C29.9099 9.46935 28.0462 7.60559 25.7552 7.60559Z"/>
            </svg>

            <svg v-if="mode.title === 'Gun game'" width="32" height="32" viewBox="0 0 32 32" class="nav__logo" xmlns="http://www.w3.org/2000/svg">
              <g>
                <path d="M23.4925 16.0021C23.4925 11.8719 20.1324 8.51172 16.0021 8.51172C11.8719 8.51172 8.51172 11.8719 8.51172 16.0021C8.51172 20.1323 11.8719 23.4925 16.0021 23.4925C20.1324 23.4924 23.4925 20.1323 23.4925 16.0021ZM20.9111 16.0021C20.9111 18.709 18.709 20.9111 16.0021 20.9111C13.2952 20.9111 11.0931 18.7089 11.0931 16.0021C11.0931 13.2952 13.2953 11.0931 16.0021 11.0931C18.709 11.093 20.9111 13.2952 20.9111 16.0021Z"/>
                <path d="M16.4276 17.7966C17.4234 17.5612 18.0398 16.5632 17.8045 15.5674C17.5691 14.5716 16.571 13.9552 15.5752 14.1906C14.5794 14.426 13.963 15.4241 14.1984 16.4198C14.4337 17.4156 15.4318 18.032 16.4276 17.7966Z"/>
                <path d="M30.0985 14.1299H29.7565C29.3548 11.1323 27.9916 8.36247 25.8166 6.18752C23.6488 4.01968 20.8899 2.65826 17.9036 2.25159V1.90153C17.9035 0.852977 17.0505 0 16.0021 0C14.9536 0 14.1005 0.852977 14.1005 1.90153V2.25159C11.1142 2.65826 8.35531 4.01968 6.18752 6.18752C4.01968 8.35537 2.65826 11.1142 2.25159 14.1005H1.90153C0.852977 14.1005 0 14.9535 0 16.002C0 17.0505 0.852977 17.9035 1.90153 17.9035H2.25159C2.65826 20.8899 4.01968 23.6488 6.18752 25.8166C8.36247 27.9915 11.1323 29.3547 14.1299 29.7564V30.0985C14.1299 31.147 14.9829 32 16.0314 32C17.0799 32 17.9329 31.147 17.9329 30.0985V29.7485C20.908 29.337 23.6559 27.9773 25.8166 25.8166C27.9774 23.6558 29.337 20.908 29.7486 17.9329H30.0985C31.147 17.9329 32 17.0798 32 16.0313C32 14.9829 31.147 14.1299 30.0985 14.1299ZM16.0314 24.7297C14.9829 24.7297 14.1299 25.5827 14.1299 26.6312V27.1403C9.40914 26.3494 5.67179 22.6203 4.8687 17.9036H5.78488C6.83337 17.9036 7.68641 17.0506 7.68641 16.0021C7.68641 14.9536 6.83343 14.1005 5.78488 14.1005H4.8687C5.67016 9.39356 9.39362 5.6701 14.1005 4.86864V5.36879C14.1005 6.41728 14.9535 7.27032 16.0021 7.27032C17.0506 7.27032 17.9036 6.41734 17.9036 5.36879V4.86864C22.6203 5.67173 26.3494 9.40907 27.1403 14.1299H26.2151C25.1666 14.1299 24.3136 14.9829 24.3136 16.0313C24.3136 17.0798 25.1666 17.9328 26.2151 17.9328H27.1305C26.3204 22.6162 22.6162 26.3202 17.9329 27.1304V26.6311C17.9329 25.5827 17.0799 24.7297 16.0314 24.7297Z"/>
              </g>
            </svg>

            <svg v-if="mode.title === 'Death match'" width="32" height="32" viewBox="0 0 32 32" class="nav__logo" xmlns="http://www.w3.org/2000/svg">
              <path d="M16.4378 0H15.4758C8.97384 0 3.75012 4.82666 3.75012 10.761V16.8905C3.75012 18.8993 5.00018 20.7006 7.00007 21.3068V25.1768C7.00007 29.003 13.9393 32 15.2267 32H16.6869C17.9741 32 25.0003 29.003 25.0003 25.1768V21.3068C27.0002 20.7008 28.2503 18.8991 28.2503 16.8905V10.761C28.2505 4.82666 22.9398 0 16.4378 0ZM15.9568 17.2469C17.0656 17.2469 17.6746 20.0739 17.6746 21.0109C17.6746 21.9087 17.1593 22.0295 16.6549 22.0295C16.5559 22.0295 16.4491 22.0254 16.3365 22.0208C16.0968 22.0111 15.8165 22.0111 15.5779 22.0208C15.465 22.0256 15.3585 22.0295 15.259 22.0295C15.0191 22.0295 14.7459 22.007 14.5401 21.8393C14.3348 21.6724 14.2393 21.4089 14.2393 21.0109C14.2393 20.0739 14.8483 17.2469 15.9568 17.2469ZM8.93519 14.0077C9.37295 13.4798 9.9976 13.1621 10.6947 13.115L11.7983 13.0397C13.2729 12.9422 14.4249 13.7002 14.4249 14.7252C14.4249 15.7062 13.4388 16.9763 12.1803 17.6165L11.2228 18.1032C10.8852 18.2752 10.5457 18.3623 10.2152 18.3623C9.28181 18.3623 8.59829 17.6839 8.47208 16.634L8.38453 15.9026C8.30184 15.2091 8.49717 14.5363 8.93519 14.0077ZM23.3809 22.0623L21.0003 22.8702V24.2531C21.0003 24.2879 20.9719 24.324 20.9647 24.3571C20.9089 25.5603 19.8299 26.2502 18.0284 26.2502H13.8079C12.3994 26.2502 11.0004 25.5618 11.0004 24.2531V22.8702L8.58165 22.0623C8.32001 21.9742 8.1723 21.6911 8.26037 21.4292C8.34792 21.1675 8.62875 21.026 8.88987 21.1145L11.648 22.0369C11.8518 22.1055 12.0003 22.2962 12.0003 22.5113V24.2536C12.0003 24.5524 12.1803 24.7725 12.4552 24.9297C12.4898 24.6873 12.7222 24.5002 12.9741 24.5002C13.2501 24.5002 13.5002 24.7242 13.5002 25.0001V25.2239C13.5002 25.239 13.6922 25.2505 13.8077 25.2505H14.5002V24.9999C14.5002 24.7239 14.7242 24.4999 15.0001 24.4999C15.2761 24.4999 15.5001 24.7239 15.5001 24.9999V25.2505H16.5V24.9999C16.5 24.7239 16.724 24.4999 17 24.4999C17.276 24.4999 17.5 24.7239 17.5 24.9999V25.2505H18.0281C18.1582 25.2505 18.2498 25.2423 18.4999 25.23V25.0001C18.4999 24.7242 18.7017 24.5002 18.9776 24.5002C19.2487 24.5002 19.4569 24.716 19.4651 24.9853C19.7508 24.8363 19.9725 24.6072 19.9725 24.2539C19.9725 24.2232 19.9996 24.1932 19.9996 24.1638V22.5115C19.9996 22.2965 20.1117 22.1058 20.3155 22.0372L23.0493 21.1148C23.3115 21.0262 23.601 21.1678 23.6886 21.4294C23.7777 21.6908 23.6428 21.9742 23.3809 22.0623ZM23.8358 15.9023L23.7482 16.6335C23.6225 17.6836 22.9385 18.362 22.0054 18.362C21.6746 18.362 21.3357 18.275 20.9975 18.1029L20.0403 17.6163C18.7815 16.976 17.7957 15.7062 17.7957 14.725C17.7957 13.6999 18.951 12.9427 20.422 13.0395L21.5259 13.1147C22.2227 13.1621 22.8474 13.4795 23.2854 14.0077C23.7237 14.5363 23.919 15.2091 23.8358 15.9023Z"/>
            </svg>

            <span class="nav__title">{{ loc(mode.title) }}</span>
          </div>
        </div>
        <div class="games__lobbies">
          <lobbies-item
            v-for="lobbie in currentLobbies"
            :key="lobbie.id"
            :lobbie="lobbie"
          />
        </div>
      </div>
    </transition>
    
  </div>
</template>

<script>
import { mapState, mapMutations, mapGetters } from 'vuex'

import LobbiesItem from './LobbiesItem'

export default {
  name: 'MainTab',

  components: { LobbiesItem },

  data: function () {
    return {
      currentModeTitle: 'Death match'
    }
  },

  computed: {
    ...mapState('arenaMenu', [
      'modes',
      'lobbies',
      'filters'
    ]),
    ...mapGetters('localization', ['loc']),
    currentLobbies: function () {
      return this.lobbies.filter(item => item.type === this.currentModeTitle)
    }
  },

  methods: {
    ...mapMutations('sounds', ['play', 'stop']),

    setCurrentMode: function (value) {
      this.currentModeTitle = value
      this.play({ name: 'choice', volume: 0.1 })
    }
  },

  mounted: function () {
    this.play({ name: 'mainMenu', volume: 0.03, loop: true })
  },

  beforeDestroy: function () {
    this.stop('mainMenu')
  }
}
</script>

<style lang="scss" scoped>
.arena-menu__main {
  display: flex;
  margin-left: 7rem;
  margin-right: 27rem;

  justify-content: space-between;
  .main__games {
    display: flex;
    flex-direction: column;
    width: 100%;
    position: relative;
    .main__logo {
      position: absolute;
      bottom: 0;
      left: 1.8rem;
      height: 10.75rem;
      width: 2.3rem;
    }
    .games__nav {
      display: flex;
      width: 100%;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      .nav__logo {
        //fill: #FFF;
        //margin: .9rem .6rem 0 0rem;
        //top: 0;
        margin: auto;
        position: absolute;
        top: 0; bottom: 0;
      }
      .nav__title {
        margin-left: 2.6rem;
        line-height: 3.7rem;
      }
      .nav__item {
        font-size: 1.1rem;
        height: 3.35rem;
        //margin: 0 0 0 0;
        margin: 0 2rem 0 0;
        text-transform: uppercase;
        position: relative;
        color: rgba(255, 255, 255, 0.4);
        fill: #404040;
        &.active {
          color: #FFF;
          fill: #FFF;
          &::after {
            position: absolute;
            content: '';
            bottom: -.1rem;
            left: 0;
            height: .1rem;
            width: 100%;
            background-color: #B6D300;
          }
        }
      }
    }
    .games__lobbies {
      display: flex;
      flex-wrap: wrap;
      align-content: stretch;
      margin: 2rem -.5rem -.5rem -.5rem;
      overflow-y: auto;
      height: 76vh;
      &::-webkit-scrollbar-track {
        background-color: #fff;
        margin: .5rem 0;
      }
      &::-webkit-scrollbar {
        width: .1rem;
        background-color: transparent;
      }
      &::-webkit-scrollbar-thumb {
        border: .05rem solid #3e454d;
        height: 33.3%;
      }
    }
  }
}
.main-games-enter-active, .main-games-leave-active {
  transition: all .4s;
}
.main-games-enter, .main-games-leave-to {
  opacity: 0;
  transform: translateX(-30px);
}
</style>
